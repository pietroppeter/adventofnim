<!DOCTYPE html>
<html lang="en-us">
<head>
  <title>2022/day01.nim</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2280%22>üê≥</text></svg>">
  <meta content="text/html; charset=utf-8" http-equiv="content-type">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link rel='stylesheet' href='https://unpkg.com/normalize.css'>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/dark.min.css">
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/pietroppeter/nimib/assets/androidstudio.css'>
  <style>
.nb-box {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.nb-small {
  font-size: 0.8rem;
}
button.nb-small {
  float: right;
  padding: 2px;
  padding-right: 5px;
  padding-left: 5px;
}
section#source {
  display:none
}

.nb-output {
  line-height: 1.15;
}
</style>
  
  <script async defer data-domain="pietroppeter.github.io/adventofnim" src="https://plausible.io/js/plausible.js"></script>
  <style>
    a {
        text-decoration: none;
        color: #009900;
    }
  
    a:hover {
        color: #99ff99;
    }
  
    em {
        color: #ffffff;
        font-style: normal;
        text-shadow: 0 0 5px #ffffff;
    }
  
    em.star {
      font-style: normal;
      color: #ffff66;
      text-shadow: 0 0 5px #ffff66;
    }
  </style>
</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js"></script><body>
<header>
<div class="nb-box">
  <span><a href="..">üè°</a></span>
  <span><code>2022/day01.nim</code></span>
  <span><a href="https://github.com/pietroppeter/adventofnim"><svg aria-hidden="true" width="1.2em" height="1.2em" style="vertical-align: middle; fill: #fff" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a></span>
</div>
<hr>
</header><main>


<h2><a href="https://adventofcode.com/2022/day/1">Day 1</a>: Calorie Counting</h2>
<ol>
<li><a href="#part1">Part 1</a></li>
<li><a href="#part2">Part 2</a></li>
<li><a href="#around">Seen around</a></li>
<li><a href="#viz">Visualizationüå∏</a></li>
</ol>
<p>First day of new year of advent of code, happy to be back here having fun with <a href="https://github.com/nim-lang/nim">nim</a>
and <a href="https://github.com/pietroppeter/nimib">nimib</a> and blogging about it. The idea for this year is to try and make visualization
with <a href="https://github.com/pietroppeter/p5nim">p5nim</a>.</p>
<p>Another thing I will be doing is using <a href="https://github.com/AngelEzquerra/nim-batteries">batteries</a> for importing common stdlib modules.
This is a nice convenience module that was supposed to improve on pattern of doing <code>include prelude</code>
but it was <a href="https://github.com/nim-lang/Nim/pull/20041">decided not to</a> put it in stdlib and you can now install it with <a href="https://github.com/nim-lang/nimble">nimble</a>.</p>
<pre><code class="nim hljs"><span class="hljs-keyword">import</span> batteries</code></pre>
<h3><a name="part1">Part 1</a></h3>
<p>Solving any puzzle you take a lot of micro decision.
Often I like to separate parsing and processing, but in cases like today
it is very convenient to do both at once:</p>
<pre><code class="nim hljs"><span class="hljs-keyword">var</span>
  elfs: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">seq</span>[<span class="hljs-built_in">int</span>]]
  elf: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">int</span>]
  maxCalories: <span class="hljs-built_in">int</span>

<span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> day.filename.lines:
  <span class="hljs-keyword">if</span> len(line.strip) &gt; <span class="hljs-number">0</span>:
    elf.add parseInt(line)
  <span class="hljs-keyword">else</span>:
    elfs.add elf
    <span class="hljs-keyword">if</span> sum(elf) &gt; maxCalories:
      maxCalories = sum(elf)
    elf = @[]
<span class="hljs-comment"># at the end I still need to add last elf</span>
<span class="hljs-keyword">if</span> len(elf) &gt; <span class="hljs-number">0</span>:
  elfs.add elf
  <span class="hljs-comment"># and maybe he is the one bringing most calories</span>
  <span class="hljs-keyword">if</span> sum(elf) &gt; maxCalories:
    maxCalories = sum(elf)

<span class="hljs-keyword">echo</span> maxCalories</code></pre><pre class="nb-output"><samp>73211</samp></pre>
<blockquote>
<p>That's the right answer! You are <em class="star">one gold star</em> closer to collecting enough star fruit.</p>
</blockquote>
<h3><a name="part2">Part 2</a></h3>
<p>Easiest (not most performant) to get top three is to sort:</p>
<pre><code class="nim hljs">sort(elfs, ((elfA, elfB) =&gt; sum(elfA) - sum(elfB)), order=<span class="hljs-type">SortOrder</span>.<span class="hljs-type">Descending</span>)

<span class="hljs-keyword">echo</span> sum elfs[<span class="hljs-number">0.</span>.<span class="hljs-number">2</span>].mapIt(sum it)</code></pre><pre class="nb-output"><samp>213958</samp></pre>
<blockquote>
<p>That's the right answer! You are <em class="star">one gold star</em> closer to collecting enough star fruit.</p>
</blockquote>
<h3><a name="around">Seen around</a></h3>
<p>Section &quot;seen around&quot; is where I gather interesting stuff seen around about advent of code for today:</p>
<ul>
<li>
<p><a href="https://www.reddit.com/r/adventofcode/comments/z9ezjb/2022_day_1_solutions/">daily solution megathread</a> to post your solution (I did!).
seen a couple of people doing it in Nim</p>
</li>
<li>
<p>community <a href="https://www.reddit.com/r/adventofcode/comments/z9he28/advent_of_code_2022_mistiltoe_elfucation/">fun event thread</a>
(I will have to participate with p5nim project)</p>
</li>
<li>
<p>unofficial participant <a href="https://www.reddit.com/r/adventofcode/comments/z9eoer/unofficial_aoc_2022_participant_survey/">survey</a>,
do it and mention you are using Nim! (I did complete the survey)</p>
</li>
<li>
<p>a nice <a href="https://www.reddit.com/r/adventofcode/comments/z9kk1m/2022_day_1_adding_up_the_calories/">visualization</a>
(apparently done in PyCairo)</p>
</li>
<li>
<p>eric wastl aka r/topaz aka creator of adventofcode is worried about user agents
and has <a href="https://www.reddit.com/r/adventofcode/comments/z9dhtd/please_include_your_contact_info_in_the_useragent/">some advice to give</a></p>
</li>
<li>
<p>this year we will have lots of AI generated visualizations here is <a href="https://www.reddit.com/r/adventofcode/comments/z9g0i0/ai_imagine_advent_of_code_2022_day_1/">one</a>
and <a href="https://www.reddit.com/r/adventofcode/comments/z9iz9t/i_may_have_mistyped_santa/">another (with demons)</a></p>
</li>
<li>
<p>I did also post <a href="https://www.reddit.com/r/adventofcode/comments/za0xyr/2022_day_1nim_visualization_with_nim_bindings_to/">my visualization</a>
on the subreddit</p>
</li>
<li>
<p>this year are back the most beatiful nim solutions, the ones by <a href="https://github.com/MichalMarsalek/Advent-of-code/blob/master/2022/Nim/day1.nim">MichalMarsalek</a></p>
</li>
<li>
<p>PMunch is streaming again this year! you can watch it <a href="https://www.twitch.tv/videos/1667530842">here</a>
(starts around 3:40, I am listening to it now)</p>
</li>
<li>
<p>someone is solving aoc with <a href="https://twitter.com/TheZachMueller/status/1598342197816004608">github copilot</a>
(the idea comes from a nice discord of data professionals emigrated from twitter, you can find the prompt in the #advent-of-code chat there <a href="https://discord.gg/jW52MxX5">invite</a>)</p>
</li>
<li>
<p>will Peter Norvig do advent of code this year? has not started committing yet, if he does
it will appear in his <a href="https://github.com/norvig/pytudes">pytudes repo</a></p>
</li>
<li>
<p>Jari Komppa last year did a great series of gifs for solutions, he is going
at it <a href="https://twitter.com/Sol_HSA/status/1598192914781597696?s=20&t=NzB5qlmO7tj5HRiSNPGdeQ">this year</a> too</p>
</li>
</ul>
<h3>Visualization</h3>
<p>Let's look at total food and number of elfs before visualizing.</p>
<pre><code class="nim hljs"><span class="hljs-keyword">echo</span> sum elfs.mapIt(sum it)
<span class="hljs-keyword">echo</span> len(elfs)</code></pre><pre class="nb-output"><samp>11936991
254</samp></pre>
<p>Here is a very simple visualization:</p>
<ul>
<li>plot a rectangle for every elf, with length proportional to the food</li>
<li>every piece of food is colored with a color extracted from a palette</li>
<li>list of palettes is taken from <a href="https://openprocessing.org/sketch/1751402">takawo</a></li>
<li>I also wait a moment before starting and wait also at the end</li>
</ul>

<pre><code class="nim hljs"><span class="hljs-keyword">const</span>
  ratio = <span class="hljs-number">100.0</span>
  hElf = <span class="hljs-number">2</span>
  idxWait = <span class="hljs-number">100</span>
<span class="hljs-keyword">var</span> idx = -<span class="hljs-number">20</span>

<span class="hljs-keyword">proc</span> showElf(x, y: <span class="hljs-built_in">float</span>, food: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">int</span>], colors: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">string</span>]) =
  push()
  translate(x, y)
  <span class="hljs-keyword">for</span> i, f <span class="hljs-keyword">in</span> food:
    fill(colors[i <span class="hljs-keyword">mod</span> colors.len])
    rect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, f / ratio, hElf)
    translate(f / ratio, <span class="hljs-number">0</span>)
  pop()

<span class="hljs-keyword">echo</span> elfs
setup:
  createCanvas(<span class="hljs-number">800</span>, hElf*len(elfs))
  <span class="hljs-comment">#createCanvas(800, 800)</span>
  background(colDark)
  frameRate(<span class="hljs-number">50</span>)
  noStroke()
draw:
  <span class="hljs-keyword">if</span> idx &lt; elfs.len:
    <span class="hljs-keyword">if</span> idx &gt;= <span class="hljs-number">0</span>: <span class="hljs-comment"># wait before starting</span>
      showElf(<span class="hljs-number">0</span>, hElf*idx, elfs[idx], palettes[idx <span class="hljs-keyword">mod</span> len palettes])
    inc idx
  <span class="hljs-keyword">else</span>:
    <span class="hljs-comment"># wait a moment</span>
    inc idx
    <span class="hljs-keyword">if</span> idx &gt; elfs.len + idxWait:
      background(colDark)
      idx = -<span class="hljs-number">60</span></code></pre>
<a name="viz"></a>

<p>for an older version of this visualization go <a href="day01_viz1.html">here</a></p>
<script defer>/* Generated by the Nim Compiler v1.6.0 */
var framePtr = null;
var excHandler = 0;
var lastJSError = null;
var NTI1056964616 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555114 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555125 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555126 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI620757014 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI33554435 = {size: 0,kind: 36,base: null,node: null,finalizer: null};
var NTI33554474 = {size: 0,kind: 35,base: null,node: null,finalizer: null};
var NTI33554466 = {size: 0,kind: 1,base: null,node: null,finalizer: null};
var NTI620756997 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI620756996 = {size: 0, kind: 22, base: null, node: null, finalizer: null};
var NTI33554456 = {size: 0,kind: 31,base: null,node: null,finalizer: null};
var NTI637534211 = {size: 0,kind: 31,base: null,node: null,finalizer: null};
var NTI620757012 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI620757009 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI620757006 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI620756995 = {size: 0, kind: 14, base: null, node: null, finalizer: null};
var NTI33555083 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555165 = {size: 0, kind: 22, base: null, node: null, finalizer: null};
var NTI33554440 = {size: 0,kind: 29,base: null,node: null,finalizer: null};
var NTI33555164 = {size: 0, kind: 22, base: null, node: null, finalizer: null};
var NTI33555112 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555113 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555129 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33554439 = {size: 0,kind: 28,base: null,node: null,finalizer: null};
var NTI1275068425 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
NTI1275068425.base = NTI33554439;
var NNI33555129 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555129.node = NNI33555129;
var NNI33555113 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555113.node = NNI33555113;
NTI33555164.base = NTI33555112;
NTI33555165.base = NTI33555112;
var NNI33555112 = {kind: 2, len: 5, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "parent", len: 0, typ: NTI33555164, name: "parent", sons: null}, 
{kind: 1, offset: "name", len: 0, typ: NTI33554440, name: "name", sons: null}, 
{kind: 1, offset: "message", len: 0, typ: NTI33554439, name: "msg", sons: null}, 
{kind: 1, offset: "trace", len: 0, typ: NTI33554439, name: "trace", sons: null}, 
{kind: 1, offset: "up", len: 0, typ: NTI33555165, name: "up", sons: null}]};
NTI33555112.node = NNI33555112;
var NNI33555083 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555083.node = NNI33555083;
NTI33555112.base = NTI33555083;
NTI33555113.base = NTI33555112;
NTI33555129.base = NTI33555113;
var NNI620756995 = {kind: 2, offset: 0, typ: null, name: null, len: 7, sons: {"0": {kind: 1, offset: 0, typ: NTI620756995, name: "JNull", len: 0, sons: null}, 
"1": {kind: 1, offset: 1, typ: NTI620756995, name: "JBool", len: 0, sons: null}, 
"2": {kind: 1, offset: 2, typ: NTI620756995, name: "JInt", len: 0, sons: null}, 
"3": {kind: 1, offset: 3, typ: NTI620756995, name: "JFloat", len: 0, sons: null}, 
"4": {kind: 1, offset: 4, typ: NTI620756995, name: "JString", len: 0, sons: null}, 
"5": {kind: 1, offset: 5, typ: NTI620756995, name: "JObject", len: 0, sons: null}, 
"6": {kind: 1, offset: 6, typ: NTI620756995, name: "JArray", len: 0, sons: null}}};
NTI620756995.node = NNI620756995;
NTI620757014.base = NTI620756996;
var NNI620756997 = {kind: 2, len: 2, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "isUnquoted", len: 0, typ: NTI33554466, name: "isUnquoted", sons: null}, 
{kind: 3, offset: "kind", len: 7, typ: NTI620756995, name: "kind", sons: [[setConstr(4), {kind: 1, offset: "str", len: 0, typ: NTI33554439, name: "str", sons: null}], 
[setConstr(2), {kind: 1, offset: "num", len: 0, typ: NTI33554474, name: "num", sons: null}], 
[setConstr(3), {kind: 1, offset: "fnum", len: 0, typ: NTI33554435, name: "fnum", sons: null}], 
[setConstr(1), {kind: 1, offset: "bval", len: 0, typ: NTI33554466, name: "bval", sons: null}], 
[setConstr(0), {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []}], 
[setConstr(5), {kind: 1, offset: "fields", len: 0, typ: NTI620757006, name: "fields", sons: null}], 
[setConstr(6), {kind: 1, offset: "elems", len: 0, typ: NTI620757014, name: "elems", sons: null}]]}]};
NTI620756997.node = NNI620756997;
NTI620756996.base = NTI620756997;
var NNI620757012 = {kind: 2, len: 4, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI637534211, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI33554456, name: "Field1", sons: null}, 
{kind: 1, offset: "Field2", len: 0, typ: NTI33554439, name: "Field2", sons: null}, 
{kind: 1, offset: "Field3", len: 0, typ: NTI620756996, name: "Field3", sons: null}]};
NTI620757012.node = NNI620757012;
NTI620757009.base = NTI620757012;
var NNI620757006 = {kind: 2, len: 4, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "data", len: 0, typ: NTI620757009, name: "data", sons: null}, 
{kind: 1, offset: "counter", len: 0, typ: NTI33554456, name: "counter", sons: null}, 
{kind: 1, offset: "first", len: 0, typ: NTI33554456, name: "first", sons: null}, 
{kind: 1, offset: "last", len: 0, typ: NTI33554456, name: "last", sons: null}]};
NTI620757006.node = NNI620757006;
var NNI33555126 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555126.node = NNI33555126;
var NNI33555125 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555125.node = NNI33555125;
var NNI33555114 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555114.node = NNI33555114;
NTI33555114.base = NTI33555112;
NTI33555125.base = NTI33555114;
NTI33555126.base = NTI33555125;
var NNI1056964616 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI1056964616.node = NNI1056964616;
NTI1056964616.base = NTI33555125;

function makeNimstrLit(c_33556802) {
      var result = [];
  for (var i = 0; i < c_33556802.length; ++i) {
    result[i] = c_33556802.charCodeAt(i);
  }
  return result;
  

  
}

function setConstr() {
        var result = {};
    for (var i = 0; i < arguments.length; ++i) {
      var x = arguments[i];
      if (typeof(x) == "object") {
        for (var j = x[0]; j <= x[1]; ++j) {
          result[j] = true;
        }
      } else {
        result[x] = true;
      }
    }
    return result;
  

  
}
var ConstSet1 = setConstr(17, 16, 4, 18, 27, 19, 23, 22, 21);

function nimCopy(dest_33557141, src_33557142, ti_33557143) {
  var result_33557152 = null;

    switch (ti_33557143.kind) {
    case 21:
    case 22:
    case 23:
    case 5:
      if (!(isFatPointer_33557132(ti_33557143))) {
      result_33557152 = src_33557142;
      }
      else {
        result_33557152 = [src_33557142[0], src_33557142[1]];
      }
      
      break;
    case 19:
            if (dest_33557141 === null || dest_33557141 === undefined) {
        dest_33557141 = {};
      }
      else {
        for (var key in dest_33557141) { delete dest_33557141[key]; }
      }
      for (var key in src_33557142) { dest_33557141[key] = src_33557142[key]; }
      result_33557152 = dest_33557141;
    
      break;
    case 18:
    case 17:
      if (!((ti_33557143.base == null))) {
      result_33557152 = nimCopy(dest_33557141, src_33557142, ti_33557143.base);
      }
      else {
      if ((ti_33557143.kind == 17)) {
      result_33557152 = (dest_33557141 === null || dest_33557141 === undefined) ? {m_type: ti_33557143} : dest_33557141;
      }
      else {
        result_33557152 = (dest_33557141 === null || dest_33557141 === undefined) ? {} : dest_33557141;
      }
      }
      nimCopyAux(result_33557152, src_33557142, ti_33557143.node);
      break;
    case 24:
    case 4:
    case 27:
    case 16:
            if (src_33557142 === null) {
        result_33557152 = null;
      }
      else {
        if (dest_33557141 === null || dest_33557141 === undefined || dest_33557141.length != src_33557142.length) {
          dest_33557141 = new Array(src_33557142.length);
        }
        result_33557152 = dest_33557141;
        for (var i = 0; i < src_33557142.length; ++i) {
          result_33557152[i] = nimCopy(result_33557152[i], src_33557142[i], ti_33557143.base);
        }
      }
    
      break;
    case 28:
            if (src_33557142 !== null) {
        result_33557152 = src_33557142.slice(0);
      }
    
      break;
    default: 
      result_33557152 = src_33557142;
      break;
    }

  return result_33557152;

}

function eqStrings(a_33556932, b_33556933) {
        if (a_33556932 == b_33556933) return true;
    if (a_33556932 === null && b_33556933.length == 0) return true;
    if (b_33556933 === null && a_33556932.length == 0) return true;
    if ((!a_33556932) || (!b_33556933)) return false;
    var alen = a_33556932.length;
    if (alen != b_33556933.length) return false;
    for (var i = 0; i < alen; ++i)
      if (a_33556932[i] != b_33556933[i]) return false;
    return true;
  

  
}
var ConstSet2 = setConstr(4);

function toJSStr(s_33556808) {
                    var Temporary5;
            var Temporary7;

  var result_33556809 = null;

    var res_33556843 = newSeq_33556826((s_33556808).length);
    var i_33556844 = 0;
    var j_33556845 = 0;
    Label1: do {
        Label2: while (true) {
        if (!(i_33556844 < (s_33556808).length)) break Label2;
          var c_33556846 = s_33556808[i_33556844];
          if ((c_33556846 < 128)) {
          res_33556843[j_33556845] = String.fromCharCode(c_33556846);
          i_33556844 += 1;
          }
          else {
            var helper_33556858 = newSeq_33556826(0);
            Label3: do {
                Label4: while (true) {
                if (!true) break Label4;
                  var code_33556859 = c_33556846.toString(16);
                  if ((((code_33556859) == null ? 0 : (code_33556859).length) == 1)) {
                  helper_33556858.push("%0");;
                  }
                  else {
                  helper_33556858.push("%");;
                  }
                  
                  helper_33556858.push(code_33556859);;
                  i_33556844 += 1;
                    if (((s_33556808).length <= i_33556844)) Temporary5 = true; else {                      Temporary5 = (s_33556808[i_33556844] < 128);                    }                  if (Temporary5) {
                  break Label3;
                  }
                  
                  c_33556846 = s_33556808[i_33556844];
                }
            } while (false);
++excHandler;
            Temporary7 = framePtr;
            try {
            res_33556843[j_33556845] = decodeURIComponent(helper_33556858.join(""));
--excHandler;
} catch (EXCEPTION) {
 var prevJSError = lastJSError;
 lastJSError = EXCEPTION;
 --excHandler;
            framePtr = Temporary7;
            res_33556843[j_33556845] = helper_33556858.join("");
            lastJSError = prevJSError;
            } finally {
            framePtr = Temporary7;
            }
          }
          
          j_33556845 += 1;
        }
    } while (false);
    if (res_33556843.length < j_33556845) { for (var i = res_33556843.length ; i < j_33556845 ; ++i) res_33556843.push(null); }
               else { res_33556843.length = j_33556845; };
    result_33556809 = res_33556843.join("");

  return result_33556809;

}

function raiseException(e_33556668, ename_33556669) {
    e_33556668.name = ename_33556669;
    if ((excHandler == 0)) {
    unhandledException(e_33556668);
    }
    
    throw e_33556668;

  
}

function raiseFieldError2(f_33556779, discVal_33556780) {
    raiseException({message: (f_33556779 || []).concat(discVal_33556780 || [],makeNimstrLit("\'") || []), parent: null, m_type: NTI33555129, name: null, trace: [], up: null}, "FieldDefect");

  
}

function mnewString(len_33556894) {
        return new Array(len_33556894);
  

  
}

function nimBoolToStr(x_33556515) {
  var result_33556516 = [];

    if (x_33556515) {
    result_33556516 = nimCopy(null, makeNimstrLit("true"), NTI33554439);
    }
    else {
      result_33556516 = nimCopy(null, makeNimstrLit("false"), NTI33554439);
    }
    

  return result_33556516;

}

function reprDiscriminant(e_33557410, typ_33557411) {
    var Temporary1;

  var result_33557412 = [];

    switch (typ_33557411.kind) {
    case 14:
      Temporary1 = reprEnum(e_33557410, typ_33557411);
      break;
    case 1:
      Temporary1 = nimBoolToStr(!((e_33557410 == 0)));
      break;
    default: 
      Temporary1 = HEX24_318767107(e_33557410);
      break;
    }
    result_33557412 = nimCopy(null, Temporary1, NTI33554439);

  return result_33557412;

}
var ConstSet3 = setConstr(4);
var ConstSet4 = setConstr(2);
var ConstSet5 = setConstr(2);
var ConstSet6 = setConstr(3);
var ConstSet7 = setConstr(3);
var ConstSet8 = setConstr(1);
var ConstSet9 = setConstr(1);
var ConstSet10 = setConstr(6);
var ConstSet11 = setConstr(6);
var ConstSet12 = setConstr(5);
var ConstSet13 = setConstr(5);
var ConstSet14 = setConstr(5);
var ConstSet15 = setConstr(5);
var ConstSet16 = setConstr(5);
var ConstSet17 = setConstr(6);

function addChar(x_33557256, c_33557257) {
    x_33557256.push(c_33557257);

  
}
var ConstSet18 = setConstr([48, 57]);
var ConstSet19 = setConstr(0, 125);
var ConstSet20 = setConstr([48, 57]);
var ConstSet21 = setConstr([65, 90]);

function nimMax(a_33556999, b_33557000) {
    var Temporary1;

  var result_33557001 = 0;

  BeforeRet: do {
    if ((b_33557000 <= a_33556999)) {
    Temporary1 = a_33556999;
    }
    else {
    Temporary1 = b_33557000;
    }
    
    result_33557001 = Temporary1;
    break BeforeRet;
  } while (false);

  return result_33557001;

}

function nimMin(a_33556995, b_33556996) {
    var Temporary1;

  var result_33556997 = 0;

  BeforeRet: do {
    if ((a_33556995 <= b_33556996)) {
    Temporary1 = a_33556995;
    }
    else {
    Temporary1 = b_33556996;
    }
    
    result_33556997 = Temporary1;
    break BeforeRet;
  } while (false);

  return result_33556997;

}
var ConstSet22 = setConstr([97, 122], [65, 90], [48, 57], [128, 255], 95);
var ConstSet23 = setConstr(6);
var ConstSet24 = setConstr(6);
var ConstSet25 = setConstr(5);
var ConstSet26 = setConstr(6);
var ConstSet27 = setConstr(6);
var ConstSet28 = setConstr(2);
var ConstSet29 = setConstr(2);
var ConstSet30 = setConstr(2);
var ConstSet31 = setConstr(6);

function cstrToNimstr(c_33556805) {
      var ln = c_33556805.length;
  var result = new Array(ln);
  var r = 0;
  for (var i = 0; i < ln; ++i) {
    var ch = c_33556805.charCodeAt(i);

    if (ch < 128) {
      result[r] = ch;
    }
    else {
      if (ch < 2048) {
        result[r] = (ch >> 6) | 192;
      }
      else {
        if (ch < 55296 || ch >= 57344) {
          result[r] = (ch >> 12) | 224;
        }
        else {
            ++i;
            ch = 65536 + (((ch & 1023) << 10) | (c_33556805.charCodeAt(i) & 1023));
            result[r] = (ch >> 18) | 240;
            ++r;
            result[r] = ((ch >> 12) & 63) | 128;
        }
        ++r;
        result[r] = ((ch >> 6) & 63) | 128;
      }
      ++r;
      result[r] = (ch & 63) | 128;
    }
    ++r;
  }
  return result;
  

  
}
var ConstSet32 = setConstr(6);

function genericReset(x_33557172, ti_33557173) {
  var result_33557174 = null;

    result_33557174 = null;
    switch (ti_33557173.kind) {
    case 21:
    case 22:
    case 23:
    case 5:
      if (isFatPointer_33557132(ti_33557173)) {
              result_33557174 = [null, 0];
      
      }
      
      break;
    case 19:
            result_33557174 = {};
    
      break;
    case 18:
    case 17:
      if ((ti_33557173.kind == 17)) {
      result_33557174 = {m_type: ti_33557173};
      }
      else {
        result_33557174 = {};
      }
      
      break;
    case 24:
    case 27:
    case 28:
            result_33557174 = [];
    
      break;
    case 4:
    case 16:
            result_33557174 = new Array(x_33557172.length);
      for (var i = 0; i < x_33557172.length; ++i) {
        result_33557174[i] = genericReset(x_33557172[i], ti_33557173.base);
      }
    
      break;
    default: 
      break;
    }

  return result_33557174;

}
var ConstSet33 = setConstr(5);

function rawEcho() {
          var buf = "";
      for (var i = 0; i < arguments.length; ++i) {
        buf += toJSStr(arguments[i]);
      }
      console.log(buf);
    

  
}
if (!Math.trunc) {
  Math.trunc = function(v) {
    v = +v;
    if (!isFinite(v)) return v;
    return (v - v % 1) || (v < 0 ? -0 : v === 0 ? v : 0);
  };
}

var objectID_637534370 = [0];

function isFatPointer_33557132(ti_33557133) {
  var result_33557134 = false;

  BeforeRet: do {
    result_33557134 = !((ConstSet1[ti_33557133.base.kind] != undefined));
    break BeforeRet;
  } while (false);

  return result_33557134;

}

function nimCopyAux(dest_33557145, src_33557146, n_33557147) {
    switch (n_33557147.kind) {
    case 0:
      break;
    case 1:
            dest_33557145[n_33557147.offset] = nimCopy(dest_33557145[n_33557147.offset], src_33557146[n_33557147.offset], n_33557147.typ);
    
      break;
    case 2:
          for (var i = 0; i < n_33557147.sons.length; i++) {
      nimCopyAux(dest_33557145, src_33557146, n_33557147.sons[i]);
    }
    
      break;
    case 3:
            dest_33557145[n_33557147.offset] = nimCopy(dest_33557145[n_33557147.offset], src_33557146[n_33557147.offset], n_33557147.typ);
      for (var i = 0; i < n_33557147.sons.length; ++i) {
        nimCopyAux(dest_33557145, src_33557146, n_33557147.sons[i][1]);
      }
    
      break;
    }

  
}
var colDark_1275068417 = makeNimstrLit("#0f0f23");
var palBenedictus_1275068422 = [makeNimstrLit("#F27EA9"), makeNimstrLit("#366CD9"), makeNimstrLit("#5EADF2"), makeNimstrLit("#636E73"), makeNimstrLit("#F2E6D8")];
var palCross_1275068427 = [makeNimstrLit("#D962AF"), makeNimstrLit("#58A6A6"), makeNimstrLit("#8AA66F"), makeNimstrLit("#F29F05"), makeNimstrLit("#F26D6D")];
var palDemuth_1275068432 = [makeNimstrLit("#222940"), makeNimstrLit("#D98E04"), makeNimstrLit("#F2A950"), makeNimstrLit("#BF3E21"), makeNimstrLit("#F2F2F2")];
var palHiroshige_1275068437 = [makeNimstrLit("#1B618C"), makeNimstrLit("#55CCD9"), makeNimstrLit("#F2BC57"), makeNimstrLit("#F2DAAC"), makeNimstrLit("#F24949")];
var palHokusai_1275068442 = [makeNimstrLit("#074A59"), makeNimstrLit("#F2C166"), makeNimstrLit("#F28241"), makeNimstrLit("#F26B5E"), makeNimstrLit("#F2F2F2")];
var palHokusaiBlue_1275068447 = [makeNimstrLit("#023059"), makeNimstrLit("#459DBF"), makeNimstrLit("#87BF60"), makeNimstrLit("#D9D16A"), makeNimstrLit("#F2F2F2")];
var palJava_1275068452 = [makeNimstrLit("#632973"), makeNimstrLit("#02734A"), makeNimstrLit("#F25C05"), makeNimstrLit("#F29188"), makeNimstrLit("#F2E0DF")];
var palKandinsky_1275068457 = [makeNimstrLit("#8D95A6"), makeNimstrLit("#0A7360"), makeNimstrLit("#F28705"), makeNimstrLit("#D98825"), makeNimstrLit("#F2F2F2")];
var palMonet_1275068462 = [makeNimstrLit("#4146A6"), makeNimstrLit("#063573"), makeNimstrLit("#5EC8F2"), makeNimstrLit("#8C4E03"), makeNimstrLit("#D98A29")];
var palNizami_1275068467 = [makeNimstrLit("#034AA6"), makeNimstrLit("#72B6F2"), makeNimstrLit("#73BFB1"), makeNimstrLit("#F2A30F"), makeNimstrLit("#F26F63")];
var palRenoir_1275068472 = [makeNimstrLit("#303E8C"), makeNimstrLit("#F2AE2E"), makeNimstrLit("#F28705"), makeNimstrLit("#D91414"), makeNimstrLit("#F2F2F2")];
var palVanGogh_1275068477 = [makeNimstrLit("#424D8C"), makeNimstrLit("#84A9BF"), makeNimstrLit("#C1D9CE"), makeNimstrLit("#F2B705"), makeNimstrLit("#F25C05")];
var palMono_1275068482 = [makeNimstrLit("#D9D7D8"), makeNimstrLit("#3B5159"), makeNimstrLit("#5D848C"), makeNimstrLit("#7CA2A6"), makeNimstrLit("#262321")];
var palRiverside_1275068487 = [makeNimstrLit("#906FA6"), makeNimstrLit("#025951"), makeNimstrLit("#252625"), makeNimstrLit("#D99191"), makeNimstrLit("#F2F2F2")];
var palettes_1275068488 = [nimCopy(null, palBenedictus_1275068422, NTI1275068425), nimCopy(null, palCross_1275068427, NTI1275068425), nimCopy(null, palDemuth_1275068432, NTI1275068425), nimCopy(null, palHiroshige_1275068437, NTI1275068425), nimCopy(null, palHokusai_1275068442, NTI1275068425), nimCopy(null, palHokusaiBlue_1275068447, NTI1275068425), nimCopy(null, palJava_1275068452, NTI1275068425), nimCopy(null, palKandinsky_1275068457, NTI1275068425), nimCopy(null, palMonet_1275068462, NTI1275068425), nimCopy(null, palNizami_1275068467, NTI1275068425), nimCopy(null, palRenoir_1275068472, NTI1275068425), nimCopy(null, palVanGogh_1275068477, NTI1275068425), nimCopy(null, palMono_1275068482, NTI1275068425), nimCopy(null, palRenoir_1275068472, NTI1275068425)];

function add_33556420(x_33556421, x_33556421_Idx, y_33556422) {
          if (x_33556421[x_33556421_Idx] === null) { x_33556421[x_33556421_Idx] = []; }
      var off = x_33556421[x_33556421_Idx].length;
      x_33556421[x_33556421_Idx].length += y_33556422.length;
      for (var i = 0; i < y_33556422.length; ++i) {
        x_33556421[x_33556421_Idx][off+i] = y_33556422.charCodeAt(i);
      }
    

  
}

function newSeq_33556826(len_33556828) {
  var result_33556829 = [];

    result_33556829 = new Array(len_33556828); for (var i = 0 ; i < len_33556828 ; ++i) { result_33556829[i] = null; }
  return result_33556829;

}

function unhandledException(e_33556664) {
    var buf_33556665 = [[]];
    if (!(((e_33556664.message).length == 0))) {
    buf_33556665[0].push.apply(buf_33556665[0], makeNimstrLit("Error: unhandled exception: "));;
    buf_33556665[0].push.apply(buf_33556665[0], e_33556664.message);;
    }
    else {
    buf_33556665[0].push.apply(buf_33556665[0], makeNimstrLit("Error: unhandled exception"));;
    }
    
    buf_33556665[0].push.apply(buf_33556665[0], makeNimstrLit(" ["));;
    add_33556420(buf_33556665, 0, e_33556664.name);
    buf_33556665[0].push.apply(buf_33556665[0], makeNimstrLit("]\x0A"));;
    var cbuf_33556666 = toJSStr(buf_33556665[0]);
    framePtr = null;
      if (typeof(Error) !== "undefined") {
    throw new Error(cbuf_33556666);
  }
  else {
    throw cbuf_33556666;
  }
  

  
}

function addChars_251658415(result_251658417, result_251658417_Idx, x_251658418, start_251658419, n_251658420) {
    var old_251658421 = (result_251658417[result_251658417_Idx]).length;
    (result_251658417[result_251658417_Idx].length = (old_251658421 + n_251658420));
    Label1: do {
      var iHEX60gensym4_251658435 = 0;
      var i_469762189 = 0;
      Label2: do {
          Label3: while (true) {
          if (!(i_469762189 < n_251658420)) break Label3;
            iHEX60gensym4_251658435 = i_469762189;
            result_251658417[result_251658417_Idx][(old_251658421 + iHEX60gensym4_251658435)] = x_251658418.charCodeAt((start_251658419 + iHEX60gensym4_251658435));
            i_469762189 += 1;
          }
      } while (false);
    } while (false);

  
}

function addChars_251658411(result_251658413, result_251658413_Idx, x_251658414) {
    addChars_251658415(result_251658413, result_251658413_Idx, x_251658414, 0, ((x_251658414) == null ? 0 : (x_251658414).length));

  
}

function addInt_251658436(result_251658437, result_251658437_Idx, x_251658438) {
    addChars_251658411(result_251658437, result_251658437_Idx, ((x_251658438) + ""));

  
}

function addInt_251658457(result_251658458, result_251658458_Idx, x_251658459) {
    addInt_251658436(result_251658458, result_251658458_Idx, x_251658459);

  
}

function HEX24_318767107(x_318767108) {
  var result_318767109 = [[]];

    addInt_251658457(result_318767109, 0, x_318767108);

  return result_318767109[0];

}

function reprEnum(e_33557386, typ_33557387) {
  var result_33557388 = [];

    var tmp_33557389 = false;
    var item_33557390 = typ_33557387.node.sons[e_33557386];
    tmp_33557389 = item_33557390 !== undefined
    if (tmp_33557389) {
    result_33557388 = nimCopy(null, makeNimstrLit(item_33557390.name), NTI33554439);
    }
    else {
      result_33557388 = nimCopy(null, (HEX24_318767107(e_33557386) || []).concat(makeNimstrLit(" (invalid data!)") || []), NTI33554439);
    }
    

  return result_33557388;

}

function HEX3DHEX3D_620759065(x_620759067, y_620759068) {
  var result_620759069 = false;

  BeforeRet: do {
    var sameObject_620759077 = false;
    sameObject_620759077 = x_620759067 === y_620759068
    if (sameObject_620759077) {
    result_620759069 = true;
    break BeforeRet;
    }
    
    if (!(((x_620759067).length == (y_620759068).length))) {
    result_620759069 = false;
    break BeforeRet;
    }
    
    Label1: do {
      var i_620759091 = 0;
      var colontmp__469762192 = 0;
      colontmp__469762192 = ((x_620759067).length - 1);
      var res_469762193 = 0;
      Label2: do {
          Label3: while (true) {
          if (!(res_469762193 <= colontmp__469762192)) break Label3;
            i_620759091 = res_469762193;
            if (!(HEX3DHEX3D_620759048(x_620759067[i_620759091], y_620759068[i_620759091]))) {
            result_620759069 = false;
            break BeforeRet;
            }
            
            res_469762193 += 1;
          }
      } while (false);
    } while (false);
    result_620759069 = true;
    break BeforeRet;
  } while (false);

  return result_620759069;

}

function len_620759136(t_620759139) {
  var result_620759140 = 0;

    result_620759140 = t_620759139.counter;

  return result_620759140;

}

function isFilled_721420319(hcode_721420320) {
  var result_721420321 = false;

    result_721420321 = !((hcode_721420320 == 0));

  return result_721420321;

}

function imul_637534525(a_637534526, b_637534527) {
  var result_637534528 = 0;

    var mask_637534529 = 65535;
    var aHi_637534534 = ((a_637534526 >>> 16) & mask_637534529);
    var aLo_637534535 = (a_637534526 & mask_637534529);
    var bHi_637534540 = ((b_637534527 >>> 16) & mask_637534529);
    var bLo_637534541 = (b_637534527 & mask_637534529);
    result_637534528 = ((((aLo_637534535 * bLo_637534541) >>> 0) + (((((aHi_637534534 * bLo_637534541) >>> 0) + ((aLo_637534535 * bHi_637534540) >>> 0)) >>> 0) << 16)) >>> 0);

  return result_637534528;

}

function rotl32_637534546(x_637534547, r_637534548) {
  var result_637534549 = 0;

    result_637534549 = ((x_637534547 << r_637534548) | (x_637534547 >>> (32 - r_637534548)));

  return result_637534549;

}

function murmurHash_637534558(x_637534559) {
  var result_637534560 = 0;

  BeforeRet: do {
    var size_637534569 = (x_637534559).length;
    var stepSize_637534570 = 4;
    var n_637534571 = Math.trunc(size_637534569 / stepSize_637534570);
    var h1_637534572 = 0;
    var i_637534573 = 0;
    Label1: do {
        Label2: while (true) {
        if (!(i_637534573 < (n_637534571 * stepSize_637534570))) break Label2;
          var k1_637534574 = 0;
          var j_637534575 = stepSize_637534570;
          Label3: do {
              Label4: while (true) {
              if (!(0 < j_637534575)) break Label4;
                j_637534575 -= 1;
                k1_637534574 = ((k1_637534574 << 8) | x_637534559[(i_637534573 + j_637534575)]);
              }
          } while (false);
          i_637534573 += stepSize_637534570;
          k1_637534574 = imul_637534525(k1_637534574, 3432918353);
          k1_637534574 = rotl32_637534546(k1_637534574, 15);
          k1_637534574 = imul_637534525(k1_637534574, 461845907);
          h1_637534572 = (h1_637534572 ^ k1_637534574);
          h1_637534572 = rotl32_637534546(h1_637534572, 13);
          h1_637534572 = ((((h1_637534572 * 5) >>> 0) + 3864292196) >>> 0);
        }
    } while (false);
    var k1_637534592 = 0;
    var rem_637534593 = Math.trunc(size_637534569 % stepSize_637534570);
    Label5: do {
        Label6: while (true) {
        if (!(0 < rem_637534593)) break Label6;
          rem_637534593 -= 1;
          k1_637534592 = ((k1_637534592 << 8) | x_637534559[(i_637534573 + rem_637534593)]);
        }
    } while (false);
    k1_637534592 = imul_637534525(k1_637534592, 3432918353);
    k1_637534592 = rotl32_637534546(k1_637534592, 15);
    k1_637534592 = imul_637534525(k1_637534592, 461845907);
    h1_637534572 = (h1_637534572 ^ k1_637534592);
    h1_637534572 = (h1_637534572 ^ size_637534569);
    h1_637534572 = (h1_637534572 ^ (h1_637534572 >>> 16));
    h1_637534572 = imul_637534525(h1_637534572, 2246822507);
    h1_637534572 = (h1_637534572 ^ (h1_637534572 >>> 13));
    h1_637534572 = imul_637534525(h1_637534572, 3266489909);
    h1_637534572 = (h1_637534572 ^ (h1_637534572 >>> 16));
    result_637534560 = (h1_637534572 | 0);
    break BeforeRet;
  } while (false);

  return result_637534560;

}

function hash_637534657(x_637534658) {
  var result_637534659 = 0;

    result_637534659 = murmurHash_637534558((x_637534658.slice(0, (x_637534658).length - 1 + 1)));

  return result_637534659;

}

function nextTry_721420322(h_721420323, maxHash_721420324) {
  var result_721420325 = 0;

    result_721420325 = ((h_721420323 + 1) & maxHash_721420324);

  return result_721420325;

}

function rawGet_620757347(t_620757350, key_620757351, hc_620757352, hc_620757352_Idx) {
            var Temporary3;

  var result_620757353 = 0;

  BeforeRet: do {
    hc_620757352[hc_620757352_Idx] = hash_637534657(key_620757351);
    if ((hc_620757352[hc_620757352_Idx] == 0)) {
    hc_620757352[hc_620757352_Idx] = 314159265;
    }
    
    if (((t_620757350.data).length == 0)) {
    result_620757353 = -1;
    break BeforeRet;
    }
    
    var h_620757404 = (hc_620757352[hc_620757352_Idx] & (t_620757350.data).length - 1);
    Label1: do {
        Label2: while (true) {
        if (!isFilled_721420319(t_620757350.data[h_620757404].Field0)) break Label2;
            if (!(t_620757350.data[h_620757404].Field0 == hc_620757352[hc_620757352_Idx])) Temporary3 = false; else {              Temporary3 = eqStrings(t_620757350.data[h_620757404].Field2, key_620757351);            }          if (Temporary3) {
          result_620757353 = h_620757404;
          break BeforeRet;
          }
          
          h_620757404 = nextTry_721420322(h_620757404, (t_620757350.data).length - 1);
        }
    } while (false);
    result_620757353 = (-1 - h_620757404);
  } while (false);

  return result_620757353;

}

function hasKey_620759558(t_620759561, key_620759562) {
  var result_620759563 = false;

    var hc_620759564 = [0];
    result_620759563 = (0 <= rawGet_620757347(t_620759561, key_620759562, hc_620759564, 0));

  return result_620759563;

}

function rawGet_620759639(t_620759642, key_620759643, hc_620759644, hc_620759644_Idx) {
            var Temporary3;

  var result_620759645 = 0;

  BeforeRet: do {
    hc_620759644[hc_620759644_Idx] = hash_637534657(key_620759643);
    if ((hc_620759644[hc_620759644_Idx] == 0)) {
    hc_620759644[hc_620759644_Idx] = 314159265;
    }
    
    if (((t_620759642.data).length == 0)) {
    result_620759645 = -1;
    break BeforeRet;
    }
    
    var h_620759696 = (hc_620759644[hc_620759644_Idx] & (t_620759642.data).length - 1);
    Label1: do {
        Label2: while (true) {
        if (!isFilled_721420319(t_620759642.data[h_620759696].Field0)) break Label2;
            if (!(t_620759642.data[h_620759696].Field0 == hc_620759644[hc_620759644_Idx])) Temporary3 = false; else {              Temporary3 = eqStrings(t_620759642.data[h_620759696].Field2, key_620759643);            }          if (Temporary3) {
          result_620759645 = h_620759696;
          break BeforeRet;
          }
          
          h_620759696 = nextTry_721420322(h_620759696, (t_620759642.data).length - 1);
        }
    } while (false);
    result_620759645 = (-1 - h_620759696);
  } while (false);

  return result_620759645;

}

function raiseKeyError_620759913(key_620759915) {
    raiseException({message: (makeNimstrLit("key not found: ") || []).concat(key_620759915 || []), parent: null, m_type: NTI33555126, name: null, trace: [], up: null}, "KeyError");

  
}

function HEX5BHEX5D_620759632(t_620759635, key_620759636) {
  var result_620759637 = null;
  var result_620759637_Idx = 0;

    var hcHEX60gensym89_620759638 = [0];
    var indexHEX60gensym89_620759859 = rawGet_620759639(t_620759635, key_620759636, hcHEX60gensym89_620759638, 0);
    if ((0 <= indexHEX60gensym89_620759859)) {
    result_620759637 = t_620759635.data[indexHEX60gensym89_620759859]; result_620759637_Idx = "Field3";
    }
    else {
    raiseKeyError_620759913(key_620759636);
    }
    

  return [result_620759637, result_620759637_Idx];

}

function HEX3DHEX3D_620759048(a_620759049, b_620759050) {
      var Temporary1;
        var Temporary2;
        var Temporary3;
        var Temporary4;
        var Temporary5;
        var Temporary6;
        var Temporary7;
        var Temporary8;
        var Temporary9;
        var Temporary10;
        var Temporary11;
          var Temporary12;
          var Temporary13;
          var Temporary15;
                  var Temporary18;
                  var Temporary19;
                  var Temporary20;

  var result_620759051 = false;

  BeforeRet: do {
    if ((a_620759049 == null)) {
    if ((b_620759050 == null)) {
    result_620759051 = true;
    break BeforeRet;
    }
    
    result_620759051 = false;
    break BeforeRet;
    }
    else {
      if ((b_620759050 == null)) Temporary1 = true; else {        Temporary1 = !((a_620759049.kind == b_620759050.kind));      }    if (Temporary1) {
    result_620759051 = false;
    break BeforeRet;
    }
    else {
      switch (a_620759049.kind) {
      case 4:
        var Temporary2 = a_620759049;
        if (ConstSet2[Temporary2.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'str\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary2.kind, NTI620756995)); }
        var Temporary3 = b_620759050;
        if (ConstSet3[Temporary3.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'str\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary3.kind, NTI620756995)); }
        result_620759051 = eqStrings(Temporary2.str, Temporary3.str);
        break;
      case 2:
        var Temporary4 = a_620759049;
        if (ConstSet4[Temporary4.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'num\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary4.kind, NTI620756995)); }
        var Temporary5 = b_620759050;
        if (ConstSet5[Temporary5.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'num\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary5.kind, NTI620756995)); }
        result_620759051 = (Temporary4.num == Temporary5.num);
        break;
      case 3:
        var Temporary6 = a_620759049;
        if (ConstSet6[Temporary6.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'fnum\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary6.kind, NTI620756995)); }
        var Temporary7 = b_620759050;
        if (ConstSet7[Temporary7.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'fnum\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary7.kind, NTI620756995)); }
        result_620759051 = (Temporary6.fnum == Temporary7.fnum);
        break;
      case 1:
        var Temporary8 = a_620759049;
        if (ConstSet8[Temporary8.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'bval\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary8.kind, NTI620756995)); }
        var Temporary9 = b_620759050;
        if (ConstSet9[Temporary9.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'bval\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary9.kind, NTI620756995)); }
        result_620759051 = (Temporary8.bval == Temporary9.bval);
        break;
      case 0:
        result_620759051 = true;
        break;
      case 6:
        var Temporary10 = a_620759049;
        if (ConstSet10[Temporary10.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'elems\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary10.kind, NTI620756995)); }
        var Temporary11 = b_620759050;
        if (ConstSet11[Temporary11.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'elems\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary11.kind, NTI620756995)); }
        result_620759051 = HEX3DHEX3D_620759065(Temporary10.elems, Temporary11.elems);
        break;
      case 5:
          var Temporary12 = a_620759049;
          if (ConstSet12[Temporary12.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'fields\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary12.kind, NTI620756995)); }
          var Temporary13 = b_620759050;
          if (ConstSet13[Temporary13.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'fields\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary13.kind, NTI620756995)); }
        if (!((len_620759136(Temporary12.fields) == len_620759136(Temporary13.fields)))) {
        result_620759051 = false;
        break BeforeRet;
        }
        
        Label14: do {
          var key_620759516 = [];
          var val_620759517 = null;
          var colontmp__469762177 = ({data: [], counter: 0, first: 0, last: 0});
          var Temporary15 = a_620759049;
          if (ConstSet14[Temporary15.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'fields\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary15.kind, NTI620756995)); }
          colontmp__469762177 = nimCopy(colontmp__469762177, Temporary15.fields, NTI620757006);
          var L_469762179 = len_620759136(colontmp__469762177);
          if ((0 < colontmp__469762177.counter)) {
          var h_469762180 = colontmp__469762177.first;
          Label16: do {
              Label17: while (true) {
              if (!(0 <= h_469762180)) break Label17;
                var nxt_469762182 = colontmp__469762177.data[h_469762180].Field1;
                if (isFilled_721420319(colontmp__469762177.data[h_469762180].Field0)) {
                key_620759516 = colontmp__469762177.data[h_469762180].Field2;
                val_620759517 = colontmp__469762177.data[h_469762180].Field3;
                  var Temporary18 = b_620759050;
                  if (ConstSet15[Temporary18.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'fields\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary18.kind, NTI620756995)); }
                if (!(hasKey_620759558(Temporary18.fields, key_620759516))) {
                result_620759051 = false;
                break BeforeRet;
                }
                
                  var Temporary19 = b_620759050;
                  if (ConstSet16[Temporary19.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'fields\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary19.kind, NTI620756995)); }
                if (!(HEX3DHEX3D_620759048((Temporary20 = HEX5BHEX5D_620759632(Temporary19.fields, key_620759516), Temporary20)[0][Temporary20[1]], val_620759517))) {
                result_620759051 = false;
                break BeforeRet;
                }
                
                }
                
                h_469762180 = nxt_469762182;
              }
          } while (false);
          }
          
        } while (false);
        result_620759051 = true;
        break;
      }
    }
    }
  } while (false);

  return result_620759051;

}

function invalidFormatString_872417296() {
    raiseException({message: makeNimstrLit("invalid format string"), parent: null, m_type: NTI33555125, name: null, trace: [], up: null}, "ValueError");

  
}

function toLowerAscii_989855745(c_989855746) {
  var result_989855747 = 0;

    if ((ConstSet21[c_989855746] != undefined)) {
    result_989855747 = (c_989855746 + 32);
    }
    else {
      result_989855747 = c_989855746;
    }
    

  return result_989855747;

}

function nsuCmpIgnoreStyle(a_872415422, b_872415423) {
          var Temporary7;
          var Temporary8;

  var result_872415424 = 0;

  BeforeRet: do {
    var aLenHEX60gensym25_872415433 = (a_872415422).length;
    var bLenHEX60gensym25_872415434 = (b_872415423).length;
    var iHEX60gensym25_872415435 = 0;
    var jHEX60gensym25_872415436 = 0;
    Label1: do {
        Label2: while (true) {
        if (!true) break Label2;
          Label3: do {
              Label4: while (true) {
              if (!((iHEX60gensym25_872415435 < aLenHEX60gensym25_872415433) && (a_872415422[iHEX60gensym25_872415435] == 95))) break Label4;
                iHEX60gensym25_872415435 += 1;
              }
          } while (false);
          Label5: do {
              Label6: while (true) {
              if (!((jHEX60gensym25_872415436 < bLenHEX60gensym25_872415434) && (b_872415423[jHEX60gensym25_872415436] == 95))) break Label6;
                jHEX60gensym25_872415436 += 1;
              }
          } while (false);
          if ((iHEX60gensym25_872415435 < aLenHEX60gensym25_872415433)) {
          Temporary7 = toLowerAscii_989855745(a_872415422[iHEX60gensym25_872415435]);
          }
          else {
          Temporary7 = 0;
          }
          
          var aaHEX60gensym25_872415445 = Temporary7;
          if ((jHEX60gensym25_872415436 < bLenHEX60gensym25_872415434)) {
          Temporary8 = toLowerAscii_989855745(b_872415423[jHEX60gensym25_872415436]);
          }
          else {
          Temporary8 = 0;
          }
          
          var bbHEX60gensym25_872415446 = Temporary8;
          result_872415424 = (aaHEX60gensym25_872415445 - bbHEX60gensym25_872415446);
          if (!((result_872415424 == 0))) {
          break BeforeRet;
          }
          
          if ((aLenHEX60gensym25_872415433 <= iHEX60gensym25_872415435)) {
          if ((bLenHEX60gensym25_872415434 <= jHEX60gensym25_872415436)) {
          result_872415424 = 0;
          break BeforeRet;
          }
          
          result_872415424 = -1;
          break BeforeRet;
          }
          else {
          if ((bLenHEX60gensym25_872415434 <= jHEX60gensym25_872415436)) {
          result_872415424 = 1;
          break BeforeRet;
          }
          }
          iHEX60gensym25_872415435 += 1;
          jHEX60gensym25_872415436 += 1;
        }
    } while (false);
  } while (false);

  return result_872415424;

}

function findNormalized_872417284(x_872417285, inArray_872417286) {
  var result_872417287 = 0;

  BeforeRet: do {
    var i_872417288 = 0;
    Label1: do {
        Label2: while (true) {
        if (!(i_872417288 < (inArray_872417286).length - 1)) break Label2;
          if ((nsuCmpIgnoreStyle(x_872417285, inArray_872417286[i_872417288]) == 0)) {
          result_872417287 = i_872417288;
          break BeforeRet;
          }
          
          i_872417288 += 2;
        }
    } while (false);
    result_872417287 = -1;
    break BeforeRet;
  } while (false);

  return result_872417287;

}

function substr_33557907(s_33557908, first_33557909, last_33557910) {
  var result_33557911 = [];

    var first_33557912 = nimMax(first_33557909, 0);
    var L_33557913 = nimMax(((nimMin(last_33557910, (s_33557908).length - 1) - first_33557912) + 1), 0);
    result_33557911 = nimCopy(null, mnewString(L_33557913), NTI33554439);
    Label1: do {
      var i_33557918 = 0;
      var colontmp__469762205 = 0;
      colontmp__469762205 = (L_33557913 - 1);
      var res_469762206 = 0;
      Label2: do {
          Label3: while (true) {
          if (!(res_469762206 <= colontmp__469762205)) break Label3;
            i_33557918 = res_469762206;
            result_33557911[i_33557918] = s_33557908[(i_33557918 + first_33557912)];
            res_469762206 += 1;
          }
      } while (false);
    } while (false);

  return result_33557911;

}

function nsuAddf(s_872417299, s_872417299_Idx, formatstr_872417300, a_872417301) {
                  var Temporary5;
            var Temporary6;
              var Temporary7;
            var Temporary10;
              var Temporary11;
                var Temporary12;
                  var Temporary15;
              var Temporary16;

    var i_872417303 = 0;
    var num_872417304 = 0;
    Label1: do {
        Label2: while (true) {
        if (!(i_872417303 < (formatstr_872417300).length)) break Label2;
          if (((formatstr_872417300[i_872417303] == 36) && ((i_872417303 + 1) < (formatstr_872417300).length))) {
          switch (formatstr_872417300[(i_872417303 + 1)]) {
          case 35:
            if (((a_872417301).length - 1 < num_872417304)) {
            invalidFormatString_872417296();
            }
            
            s_872417299[s_872417299_Idx].push.apply(s_872417299[s_872417299_Idx], a_872417301[num_872417304]);;
            i_872417303 += 2;
            num_872417304 += 1;
            break;
          case 36:
            addChar(s_872417299[s_872417299_Idx], 36);;
            i_872417303 += 2;
            break;
          case 49:
          case 50:
          case 51:
          case 52:
          case 53:
          case 54:
          case 55:
          case 56:
          case 57:
          case 45:
            var j_872417320 = 0;
            i_872417303 += 1;
            var negative_872417325 = (formatstr_872417300[i_872417303] == 45);
            if (negative_872417325) {
            i_872417303 += 1;
            }
            
            Label3: do {
                Label4: while (true) {
                  if (!(i_872417303 < (formatstr_872417300).length)) Temporary5 = false; else {                    Temporary5 = (ConstSet18[formatstr_872417300[i_872417303]] != undefined);                  }                if (!Temporary5) break Label4;
                  j_872417320 = (((j_872417320 * 10) + formatstr_872417300[i_872417303]) - 48);
                  i_872417303 += 1;
                }
            } while (false);
            if (!(negative_872417325)) {
            Temporary6 = (j_872417320 - 1);
            }
            else {
            Temporary6 = ((a_872417301).length - j_872417320);
            }
            
            var idx_872417348 = Temporary6;
              if ((idx_872417348 < 0)) Temporary7 = true; else {                Temporary7 = ((a_872417301).length - 1 < idx_872417348);              }            if (Temporary7) {
            invalidFormatString_872417296();
            }
            
            s_872417299[s_872417299_Idx].push.apply(s_872417299[s_872417299_Idx], a_872417301[idx_872417348]);;
            break;
          case 123:
            var j_872417352 = (i_872417303 + 2);
            var k_872417353 = 0;
            var negative_872417354 = (formatstr_872417300[j_872417352] == 45);
            if (negative_872417354) {
            j_872417352 += 1;
            }
            
            var isNumber_872417359 = 0;
            Label8: do {
                Label9: while (true) {
                if (!((j_872417352 < (formatstr_872417300).length) && !((ConstSet19[formatstr_872417300[j_872417352]] != undefined)))) break Label9;
                  if ((ConstSet20[formatstr_872417300[j_872417352]] != undefined)) {
                  k_872417353 = (((k_872417353 * 10) + formatstr_872417300[j_872417352]) - 48);
                  if ((isNumber_872417359 == 0)) {
                  isNumber_872417359 = 1;
                  }
                  
                  }
                  else {
                    isNumber_872417359 = -1;
                  }
                  
                  j_872417352 += 1;
                }
            } while (false);
            if ((isNumber_872417359 == 1)) {
            if (!(negative_872417354)) {
            Temporary10 = (k_872417353 - 1);
            }
            else {
            Temporary10 = ((a_872417301).length - k_872417353);
            }
            
            var idx_872417381 = Temporary10;
              if ((idx_872417381 < 0)) Temporary11 = true; else {                Temporary11 = ((a_872417301).length - 1 < idx_872417381);              }            if (Temporary11) {
            invalidFormatString_872417296();
            }
            
            s_872417299[s_872417299_Idx].push.apply(s_872417299[s_872417299_Idx], a_872417301[idx_872417381]);;
            }
            else {
              var x_872417385 = findNormalized_872417284(substr_33557907(formatstr_872417300, (i_872417303 + 2), (j_872417352 - 1)), a_872417301);
                if (!(0 <= x_872417385)) Temporary12 = false; else {                  Temporary12 = (x_872417385 < (a_872417301).length - 1);                }              if (Temporary12) {
              s_872417299[s_872417299_Idx].push.apply(s_872417299[s_872417299_Idx], a_872417301[(x_872417385 + 1)]);;
              }
              else {
              invalidFormatString_872417296();
              }
              
            }
            
            i_872417303 = (j_872417352 + 1);
            break;
          case 97:
          case 98:
          case 99:
          case 100:
          case 101:
          case 102:
          case 103:
          case 104:
          case 105:
          case 106:
          case 107:
          case 108:
          case 109:
          case 110:
          case 111:
          case 112:
          case 113:
          case 114:
          case 115:
          case 116:
          case 117:
          case 118:
          case 119:
          case 120:
          case 121:
          case 122:
          case 65:
          case 66:
          case 67:
          case 68:
          case 69:
          case 70:
          case 71:
          case 72:
          case 73:
          case 74:
          case 75:
          case 76:
          case 77:
          case 78:
          case 79:
          case 80:
          case 81:
          case 82:
          case 83:
          case 84:
          case 85:
          case 86:
          case 87:
          case 88:
          case 89:
          case 90:
          case 128:
          case 129:
          case 130:
          case 131:
          case 132:
          case 133:
          case 134:
          case 135:
          case 136:
          case 137:
          case 138:
          case 139:
          case 140:
          case 141:
          case 142:
          case 143:
          case 144:
          case 145:
          case 146:
          case 147:
          case 148:
          case 149:
          case 150:
          case 151:
          case 152:
          case 153:
          case 154:
          case 155:
          case 156:
          case 157:
          case 158:
          case 159:
          case 160:
          case 161:
          case 162:
          case 163:
          case 164:
          case 165:
          case 166:
          case 167:
          case 168:
          case 169:
          case 170:
          case 171:
          case 172:
          case 173:
          case 174:
          case 175:
          case 176:
          case 177:
          case 178:
          case 179:
          case 180:
          case 181:
          case 182:
          case 183:
          case 184:
          case 185:
          case 186:
          case 187:
          case 188:
          case 189:
          case 190:
          case 191:
          case 192:
          case 193:
          case 194:
          case 195:
          case 196:
          case 197:
          case 198:
          case 199:
          case 200:
          case 201:
          case 202:
          case 203:
          case 204:
          case 205:
          case 206:
          case 207:
          case 208:
          case 209:
          case 210:
          case 211:
          case 212:
          case 213:
          case 214:
          case 215:
          case 216:
          case 217:
          case 218:
          case 219:
          case 220:
          case 221:
          case 222:
          case 223:
          case 224:
          case 225:
          case 226:
          case 227:
          case 228:
          case 229:
          case 230:
          case 231:
          case 232:
          case 233:
          case 234:
          case 235:
          case 236:
          case 237:
          case 238:
          case 239:
          case 240:
          case 241:
          case 242:
          case 243:
          case 244:
          case 245:
          case 246:
          case 247:
          case 248:
          case 249:
          case 250:
          case 251:
          case 252:
          case 253:
          case 254:
          case 255:
          case 95:
            var j_872417389 = (i_872417303 + 1);
            Label13: do {
                Label14: while (true) {
                  if (!(j_872417389 < (formatstr_872417300).length)) Temporary15 = false; else {                    Temporary15 = (ConstSet22[formatstr_872417300[j_872417389]] != undefined);                  }                if (!Temporary15) break Label14;
                  j_872417389 += 1;
                }
            } while (false);
            var x_872417398 = findNormalized_872417284(substr_33557907(formatstr_872417300, (i_872417303 + 1), (j_872417389 - 1)), a_872417301);
              if (!(0 <= x_872417398)) Temporary16 = false; else {                Temporary16 = (x_872417398 < (a_872417301).length - 1);              }            if (Temporary16) {
            s_872417299[s_872417299_Idx].push.apply(s_872417299[s_872417299_Idx], a_872417301[(x_872417398 + 1)]);;
            }
            else {
            invalidFormatString_872417296();
            }
            
            i_872417303 = j_872417389;
            break;
          default: 
            invalidFormatString_872417296();
            break;
          }
          }
          else {
            addChar(s_872417299[s_872417299_Idx], formatstr_872417300[i_872417303]);;
            i_872417303 += 1;
          }
          
        }
    } while (false);

  
}

function nsuFormatOpenArray(formatstr_872417407, a_872417408) {
  var result_872417409 = [[]];

    result_872417409[0] = nimCopy(null, mnewString(0), NTI33554439);
    nsuAddf(result_872417409, 0, formatstr_872417407, a_872417408);

  return result_872417409[0];

}

function addQuoted_620762449(s_620762451, s_620762451_Idx, x_620762452) {
    s_620762451[s_620762451_Idx].push.apply(s_620762451[s_620762451_Idx], reprEnum(x_620762452, NTI620756995));;

  
}

function collectionToString_620762417(x_620762419, prefix_620762420, separator_620762421, suffix_620762422) {
  var result_620762423 = [[]];

    result_620762423[0] = nimCopy(null, prefix_620762420, NTI33554439);
    var firstElement_620762424 = true;
    Label1: do {
      var value_620762445 = 0;
      var i_469762210 = 0;
      Label2: do {
          Label3: while (true) {
          if (!(i_469762210 <= 6)) break Label3;
            if ((x_620762419[i_469762210] != undefined)) {
            value_620762445 = i_469762210;
            if (firstElement_620762424) {
            firstElement_620762424 = false;
            }
            else {
            result_620762423[0].push.apply(result_620762423[0], separator_620762421);;
            }
            
            addQuoted_620762449(result_620762423, 0, value_620762445);
            }
            
            i_469762210 += 1;
          }
      } while (false);
    } while (false);
    result_620762423[0].push.apply(result_620762423[0], suffix_620762422);;

  return result_620762423[0];

}

function HEX24_620762413(x_620762415) {
  var result_620762416 = [];

    result_620762416 = nimCopy(null, collectionToString_620762417(x_620762415, makeNimstrLit("{"), makeNimstrLit(", "), makeNimstrLit("}")), NTI33554439);

  return result_620762416;

}

function len_620760002(n_620760003) {
      var Temporary1;
      var Temporary2;

  var result_620760004 = 0;

    switch (n_620760003.kind) {
    case 6:
      var Temporary1 = n_620760003;
      if (ConstSet24[Temporary1.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'elems\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary1.kind, NTI620756995)); }
      result_620760004 = (Temporary1.elems).length;
      break;
    case 5:
      var Temporary2 = n_620760003;
      if (ConstSet25[Temporary2.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'fields\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary2.kind, NTI620756995)); }
      result_620760004 = len_620759136(Temporary2.fields);
      break;
    default: 
      break;
    }

  return result_620760004;

}

function initFromJson_469762135(dst_469762137, dst_469762137_Idx, jsonNode_469762138, jsonPath_469762139, jsonPath_469762139_Idx) {
    var Temporary1;

    if (HEX3DHEX3D_620759048(jsonNode_469762138, null)) {
    raiseException({message: (makeNimstrLit("key not found: ") || []).concat(jsonPath_469762139[jsonPath_469762139_Idx] || []), parent: null, m_type: NTI33555126, name: null, trace: [], up: null}, "KeyError");
    }
    else {
    if (!((ConstSet28[jsonNode_469762138.kind] != undefined))) {
    var msgHEX60gensym8_469762156 = nsuFormatOpenArray(makeNimstrLit("Incorrect JSON kind. Wanted \'$1\' in \'$2\' but got \'$3\'."), [HEX24_620762413(ConstSet29), nimCopy(null, jsonPath_469762139[jsonPath_469762139_Idx], NTI33554439), reprEnum(jsonNode_469762138.kind, NTI620756995)]);
    raiseException({message: nimCopy(null, msgHEX60gensym8_469762156, NTI33554439), parent: null, m_type: NTI1056964616, name: null, trace: [], up: null}, "JsonKindError");
    }
    }
    var Temporary1 = jsonNode_469762138;
    if (ConstSet30[Temporary1.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'num\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary1.kind, NTI620756995)); }
    dst_469762137[dst_469762137_Idx] = Temporary1.num;

  
}

function HEX5BHEX5D_620760131(node_620760132, index_620760133) {
    var Temporary1;
    var Temporary2;

  var result_620760134 = null;

  BeforeRet: do {
    var Temporary1 = node_620760132;
    if (ConstSet31[Temporary1.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'elems\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary1.kind, NTI620756995)); }
    result_620760134 = (Temporary2 = Temporary1.elems, Temporary2)[index_620760133];
    break BeforeRet;
  } while (false);

  return result_620760134;

}

function initFromJson_469762106(dst_469762108, dst_469762108_Idx, jsonNode_469762109, jsonPath_469762110, jsonPath_469762110_Idx) {
    var Temporary1;

    if (HEX3DHEX3D_620759048(jsonNode_469762109, null)) {
    raiseException({message: (makeNimstrLit("key not found: ") || []).concat(jsonPath_469762110[jsonPath_469762110_Idx] || []), parent: null, m_type: NTI33555126, name: null, trace: [], up: null}, "KeyError");
    }
    else {
    if (!((ConstSet26[jsonNode_469762109.kind] != undefined))) {
    var msgHEX60gensym4_469762123 = nsuFormatOpenArray(makeNimstrLit("Incorrect JSON kind. Wanted \'$1\' in \'$2\' but got \'$3\'."), [HEX24_620762413(ConstSet27), nimCopy(null, jsonPath_469762110[jsonPath_469762110_Idx], NTI33554439), reprEnum(jsonNode_469762109.kind, NTI620756995)]);
    raiseException({message: nimCopy(null, msgHEX60gensym4_469762123, NTI33554439), parent: null, m_type: NTI1056964616, name: null, trace: [], up: null}, "JsonKindError");
    }
    }
    if (dst_469762108[dst_469762108_Idx].length < (Temporary1 = len_620760002(jsonNode_469762109), Temporary1)) { for (var i = dst_469762108[dst_469762108_Idx].length ; i < Temporary1 ; ++i) dst_469762108[dst_469762108_Idx].push(0); }
               else { dst_469762108[dst_469762108_Idx].length = Temporary1; };
    var orignalJsonPathLen_469762129 = (jsonPath_469762110[jsonPath_469762110_Idx]).length;
    Label2: do {
      var i_469762134 = 0;
      var colontmp__469762213 = 0;
      colontmp__469762213 = len_620760002(jsonNode_469762109);
      var i_469762214 = 0;
      Label3: do {
          Label4: while (true) {
          if (!(i_469762214 < colontmp__469762213)) break Label4;
            i_469762134 = i_469762214;
            addChar(jsonPath_469762110[jsonPath_469762110_Idx], 91);;
            addInt_251658457(jsonPath_469762110, jsonPath_469762110_Idx, i_469762134);
            addChar(jsonPath_469762110[jsonPath_469762110_Idx], 93);;
            initFromJson_469762135(dst_469762108[dst_469762108_Idx], i_469762134, HEX5BHEX5D_620760131(jsonNode_469762109, i_469762134), jsonPath_469762110, jsonPath_469762110_Idx);
            (jsonPath_469762110[jsonPath_469762110_Idx].length = orignalJsonPathLen_469762129);
            i_469762214 += 1;
          }
      } while (false);
    } while (false);

  
}

function initFromJson_469762077(dst_469762079, dst_469762079_Idx, jsonNode_469762080, jsonPath_469762081, jsonPath_469762081_Idx) {
    var Temporary1;

    if (HEX3DHEX3D_620759048(jsonNode_469762080, null)) {
    raiseException({message: (makeNimstrLit("key not found: ") || []).concat(jsonPath_469762081[jsonPath_469762081_Idx] || []), parent: null, m_type: NTI33555126, name: null, trace: [], up: null}, "KeyError");
    }
    else {
    if (!((ConstSet17[jsonNode_469762080.kind] != undefined))) {
    var msgHEX60gensym0_469762094 = nsuFormatOpenArray(makeNimstrLit("Incorrect JSON kind. Wanted \'$1\' in \'$2\' but got \'$3\'."), [HEX24_620762413(ConstSet23), nimCopy(null, jsonPath_469762081[jsonPath_469762081_Idx], NTI33554439), reprEnum(jsonNode_469762080.kind, NTI620756995)]);
    raiseException({message: nimCopy(null, msgHEX60gensym0_469762094, NTI33554439), parent: null, m_type: NTI1056964616, name: null, trace: [], up: null}, "JsonKindError");
    }
    }
    if (dst_469762079[dst_469762079_Idx].length < (Temporary1 = len_620760002(jsonNode_469762080), Temporary1)) { for (var i = dst_469762079[dst_469762079_Idx].length ; i < Temporary1 ; ++i) dst_469762079[dst_469762079_Idx].push([]); }
               else { dst_469762079[dst_469762079_Idx].length = Temporary1; };
    var orignalJsonPathLen_469762100 = (jsonPath_469762081[jsonPath_469762081_Idx]).length;
    Label2: do {
      var i_469762105 = 0;
      var colontmp__469762173 = 0;
      colontmp__469762173 = len_620760002(jsonNode_469762080);
      var i_469762174 = 0;
      Label3: do {
          Label4: while (true) {
          if (!(i_469762174 < colontmp__469762173)) break Label4;
            i_469762105 = i_469762174;
            addChar(jsonPath_469762081[jsonPath_469762081_Idx], 91);;
            addInt_251658457(jsonPath_469762081, jsonPath_469762081_Idx, i_469762105);
            addChar(jsonPath_469762081[jsonPath_469762081_Idx], 93);;
            initFromJson_469762106(dst_469762079[dst_469762079_Idx], i_469762105, HEX5BHEX5D_620760131(jsonNode_469762080, i_469762105), jsonPath_469762081, jsonPath_469762081_Idx);
            (jsonPath_469762081[jsonPath_469762081_Idx].length = orignalJsonPathLen_469762100);
            i_469762174 += 1;
          }
      } while (false);
    } while (false);

  
}

function to_469762070(node_469762073) {
  var result_469762075 = [[]];

    var jsonPath_469762076 = [[]];
    initFromJson_469762077(result_469762075, 0, node_469762073, jsonPath_469762076, 0);

  return result_469762075[0];

}

function getVarType_620762258(x_620762259, isRawNumber_620762260, isRawNumber_620762260_Idx) {
        var Temporary1;

  var result_620762261 = 0;

  BeforeRet: do {
    result_620762261 = 0;
    switch (toJSStr(cstrToNimstr(Object.prototype.toString.call(x_620762259)))) {
    case "[object Array]":
      result_620762261 = 6;
      break BeforeRet;
      break;
    case "[object Object]":
      result_620762261 = 5;
      break BeforeRet;
      break;
    case "[object Number]":
        if (!Number.isInteger(x_620762259)) Temporary1 = false; else {          Temporary1 = !(((1.0 / x_620762259) == -Infinity));        }      if (Temporary1) {
      if (Number.isSafeInteger(x_620762259)) {
      result_620762261 = 2;
      break BeforeRet;
      }
      else {
        isRawNumber_620762260[isRawNumber_620762260_Idx] = true;
        result_620762261 = 4;
        break BeforeRet;
      }
      
      }
      else {
        result_620762261 = 3;
        break BeforeRet;
      }
      
      break;
    case "[object Boolean]":
      result_620762261 = 1;
      break BeforeRet;
      break;
    case "[object Null]":
      result_620762261 = 0;
      break BeforeRet;
      break;
    case "[object String]":
      result_620762261 = 4;
      break BeforeRet;
      break;
    default: 
      break;
    }
  } while (false);

  return result_620762261;

}

function newJArray_620757114() {
  var result_620757115 = null;

    result_620757115 = {kind: 6, elems: [], isUnquoted: false, str: [], num: 0, fnum: 0.0, bval: false, fields: ({data: [], counter: 0, first: 0, last: 0})};

  return result_620757115;

}

function len_620762277(x_620762278) {
  var result_620762279 = 0;

          result_620762279 = x_620762278.length;
    

  return result_620762279;

}

function add_620757213(father_620757214, child_620757215) {
    var Temporary1;

    var Temporary1 = father_620757214;
    if (ConstSet32[Temporary1.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'elems\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary1.kind, NTI620756995)); }
    Temporary1.elems.push(child_620757215);;

  
}

function nextPowerOfTwo_738197676(x_738197677) {
  var result_738197678 = 0;

    result_738197678 = (x_738197677 - 1);
    result_738197678 = (result_738197678 | (result_738197678 >> 16));
    result_738197678 = (result_738197678 | (result_738197678 >> 8));
    result_738197678 = (result_738197678 | (result_738197678 >> 4));
    result_738197678 = (result_738197678 | (result_738197678 >> 2));
    result_738197678 = (result_738197678 | (result_738197678 >> 1));
    result_738197678 += (1 + ((x_738197677 <= 0) ? 1 : 0));

  return result_738197678;

}

function slotsNeeded_721420330(count_721420331) {
  var result_721420332 = 0;

    result_721420332 = nextPowerOfTwo_738197676((Math.trunc((count_721420331 * 3) / 2) + 4));

  return result_721420332;

}

function initOrderedTable_620757085(initialSize_620757088) {
  var result_620757089 = ({data: [], counter: 0, first: 0, last: 0});

    var correctSizeHEX60gensym0_620757091 = slotsNeeded_721420330(initialSize_620757088);
    result_620757089.counter = 0;
    result_620757089.data = new Array(correctSizeHEX60gensym0_620757091); for (var i = 0 ; i < correctSizeHEX60gensym0_620757091 ; ++i) { result_620757089.data[i] = {Field0: 0, Field1: 0, Field2: [], Field3: null}; }    result_620757089.first = -1;
    result_620757089.last = -1;

  return result_620757089;

}

function newJObject_620757083() {
  var result_620757084 = null;

    result_620757084 = {kind: 5, fields: initOrderedTable_620757085(2), isUnquoted: false, str: [], num: 0, fnum: 0.0, bval: false, elems: []};

  return result_620757084;

}

function mustRehash_620757683(t_620757685) {
  var result_620757686 = false;

    result_620757686 = ((((t_620757685.data).length * 2) < (t_620757685.counter * 3)) || (((t_620757685.data).length - t_620757685.counter) < 4));

  return result_620757686;

}

function rawInsert_620758259(t_620758262, data_620758263, data_620758263_Idx, key_620758264, val_620758265, hc_620758266, h_620758267) {
    data_620758263[data_620758263_Idx][h_620758267].Field2 = nimCopy(null, key_620758264, NTI33554439);
    data_620758263[data_620758263_Idx][h_620758267].Field3 = val_620758265;
    data_620758263[data_620758263_Idx][h_620758267].Field0 = hc_620758266;
    data_620758263[data_620758263_Idx][h_620758267].Field1 = -1;
    if ((t_620758262.first < 0)) {
    t_620758262.first = h_620758267;
    }
    
    if ((0 <= t_620758262.last)) {
    data_620758263[data_620758263_Idx][t_620758262.last].Field1 = h_620758267;
    }
    
    t_620758262.last = h_620758267;

  
}

function enlarge_620757844(t_620757847) {
          var Temporary6;
          var Temporary7;

    var n_620757850 = [];
    n_620757850 = new Array(((t_620757847.data).length * 2)); for (var i = 0 ; i < ((t_620757847.data).length * 2) ; ++i) { n_620757850[i] = {Field0: 0, Field1: 0, Field2: [], Field3: null}; }    var h_620757902 = t_620757847.first;
    t_620757847.first = -1;
    t_620757847.last = -1;
    var Temporary1 = t_620757847.data; t_620757847.data = n_620757850; n_620757850 = Temporary1;    Label2: do {
        Label3: while (true) {
        if (!(0 <= h_620757902)) break Label3;
          var nxt_620757960 = n_620757850[h_620757902].Field1;
          var eh_620758014 = n_620757850[h_620757902].Field0;
          if (isFilled_721420319(eh_620758014)) {
          var j_620758018 = (eh_620758014 & (t_620757847.data).length - 1);
          Label4: do {
              Label5: while (true) {
              if (!isFilled_721420319(t_620757847.data[j_620758018].Field0)) break Label5;
                j_620758018 = nextTry_721420322(j_620758018, (t_620757847.data).length - 1);
              }
          } while (false);
          Temporary6 = n_620757850[h_620757902].Field2;
          n_620757850[h_620757902].Field2 = genericReset(n_620757850[h_620757902].Field2, NTI33554439);
          Temporary7 = n_620757850[h_620757902].Field3;
          n_620757850[h_620757902].Field3 = genericReset(n_620757850[h_620757902].Field3, NTI620756996);
          rawInsert_620758259(t_620757847, t_620757847, "data", Temporary6, Temporary7, n_620757850[h_620757902].Field0, j_620758018);
          }
          
          h_620757902 = nxt_620757960;
        }
    } while (false);

  
}

function rawGetKnownHC_620758541(t_620758544, key_620758545, hc_620758546) {
  var result_620758547 = 0;

  BeforeRet: do {
    if (((t_620758544.data).length == 0)) {
    result_620758547 = -1;
    break BeforeRet;
    }
    
    var h_620758598 = (hc_620758546 & (t_620758544.data).length - 1);
    Label1: do {
        Label2: while (true) {
        if (!isFilled_721420319(t_620758544.data[h_620758598].Field0)) break Label2;
          if (((t_620758544.data[h_620758598].Field0 == hc_620758546) && eqStrings(t_620758544.data[h_620758598].Field2, key_620758545))) {
          result_620758547 = h_620758598;
          break BeforeRet;
          }
          
          h_620758598 = nextTry_721420322(h_620758598, (t_620758544.data).length - 1);
        }
    } while (false);
    result_620758547 = (-1 - h_620758598);
  } while (false);

  return result_620758547;

}

function HEX5BHEX5DHEX3D_620757278(t_620757281, key_620757282, val_620757283) {
    if (((t_620757281.data).length == 0)) {
    var correctSizeHEX60gensym13_620757333 = slotsNeeded_721420330(32);
    t_620757281.counter = 0;
    t_620757281.data = new Array(correctSizeHEX60gensym13_620757333); for (var i = 0 ; i < correctSizeHEX60gensym13_620757333 ; ++i) { t_620757281.data[i] = {Field0: 0, Field1: 0, Field2: [], Field3: null}; }    t_620757281.first = -1;
    t_620757281.last = -1;
    }
    
    var hc_620757338 = [0];
    var index_620757576 = rawGet_620757347(t_620757281, key_620757282, hc_620757338, 0);
    if ((0 <= index_620757576)) {
    t_620757281.data[index_620757576].Field3 = val_620757283;
    }
    else {
      if (((t_620757281.data).length == 0)) {
      var correctSizeHEX60gensym18_620757678 = slotsNeeded_721420330(32);
      t_620757281.counter = 0;
      t_620757281.data = new Array(correctSizeHEX60gensym18_620757678); for (var i = 0 ; i < correctSizeHEX60gensym18_620757678 ; ++i) { t_620757281.data[i] = {Field0: 0, Field1: 0, Field2: [], Field3: null}; }      t_620757281.first = -1;
      t_620757281.last = -1;
      }
      
      if (mustRehash_620757683(t_620757281)) {
      enlarge_620757844(t_620757281);
      index_620757576 = rawGetKnownHC_620758541(t_620757281, key_620757282, hc_620757338[0]);
      }
      
      index_620757576 = (-1 - index_620757576);
      rawInsert_620758259(t_620757281, t_620757281, "data", key_620757282, val_620757283, hc_620757338[0], index_620757576);
      t_620757281.counter += 1;
    }
    

  
}

function HEX5BHEX5DHEX3D_620758918(obj_620758919, key_620758920, val_620758921) {
    var Temporary1;

    var Temporary1 = obj_620758919;
    if (ConstSet33[Temporary1.kind]===undefined) { raiseFieldError2(makeNimstrLit("field \'fields\' is not accessible for type \'JsonNodeObj\' using \'kind = "), reprDiscriminant(Temporary1.kind, NTI620756995)); }
    HEX5BHEX5DHEX3D_620757278(Temporary1.fields, key_620758920, val_620758921);

  
}

function newJInt_620757072(n_620757073) {
  var result_620757074 = null;

    result_620757074 = {kind: 2, num: n_620757073, isUnquoted: false, str: [], fnum: 0.0, bval: false, fields: ({data: [], counter: 0, first: 0, last: 0}), elems: []};

  return result_620757074;

}

function newJFloat_620757075(n_620757076) {
  var result_620757077 = null;

    result_620757077 = {kind: 3, fnum: n_620757076, isUnquoted: false, str: [], num: 0, bval: false, fields: ({data: [], counter: 0, first: 0, last: 0}), elems: []};

  return result_620757077;

}

function newJRawNumber_620757066(s_620757067) {
  var result_620757068 = null;

    result_620757068 = {kind: 4, str: nimCopy(null, s_620757067, NTI33554439), isUnquoted: true, num: 0, fnum: 0.0, bval: false, fields: ({data: [], counter: 0, first: 0, last: 0}), elems: []};

  return result_620757068;

}

function newJString_620757033(s_620757034) {
  var result_620757035 = null;

    result_620757035 = {kind: 4, str: nimCopy(null, s_620757034, NTI33554439), isUnquoted: false, num: 0, fnum: 0.0, bval: false, fields: ({data: [], counter: 0, first: 0, last: 0}), elems: []};

  return result_620757035;

}

function newJBool_620757078(b_620757079) {
  var result_620757080 = null;

    result_620757080 = {kind: 1, bval: b_620757079, isUnquoted: false, str: [], num: 0, fnum: 0.0, fields: ({data: [], counter: 0, first: 0, last: 0}), elems: []};

  return result_620757080;

}

function newJNull_620757081() {
  var result_620757082 = null;

    result_620757082 = {kind: 0, isUnquoted: false, str: [], num: 0, fnum: 0.0, bval: false, fields: ({data: [], counter: 0, first: 0, last: 0}), elems: []};

  return result_620757082;

}

function convertObject_620762280(x_620762281) {
  var result_620762282 = null;

    var isRawNumber_620762283 = [false];
    switch (getVarType_620762258(x_620762281, isRawNumber_620762283, 0)) {
    case 6:
      result_620762282 = newJArray_620757114();
      Label1: do {
        var i_620762288 = 0;
        var colontmp__469762217 = 0;
        colontmp__469762217 = len_620762277(x_620762281);
        var i_469762218 = 0;
        Label2: do {
            Label3: while (true) {
            if (!(i_469762218 < colontmp__469762217)) break Label3;
              i_620762288 = i_469762218;
              add_620757213(result_620762282, convertObject_620762280(x_620762281[i_620762288]));
              i_469762218 += 1;
            }
        } while (false);
      } while (false);
      break;
    case 5:
      result_620762282 = newJObject_620757083();
      for (var property in x_620762281) {
        if (x_620762281.hasOwnProperty(property)) {
      
      var nimProperty_620762289 = null;
      var nimValue_620762290 = null;
      nimProperty_620762289 = property; nimValue_620762290 = x_620762281[property];
      HEX5BHEX5DHEX3D_620758918(result_620762282, cstrToNimstr(nimProperty_620762289), convertObject_620762280(nimValue_620762290));
      }}
      break;
    case 2:
      result_620762282 = newJInt_620757072((x_620762281));
      break;
    case 3:
      result_620762282 = newJFloat_620757075((x_620762281));
      break;
    case 4:
      if (isRawNumber_620762283[0]) {
      var value_620762299 = null;
      value_620762299 = x_620762281.toString();
      result_620762282 = newJRawNumber_620757066(cstrToNimstr(value_620762299));
      }
      else {
        result_620762282 = newJString_620757033(cstrToNimstr((x_620762281)));
      }
      
      break;
    case 1:
      result_620762282 = newJBool_620757078((x_620762281));
      break;
    case 0:
      result_620762282 = newJNull_620757081();
      break;
    }

  return result_620762282;

}

function parseJson_620762308(buffer_620762309) {
  var result_620762310 = null;

  BeforeRet: do {
    result_620762310 = convertObject_620762280(JSON.parse(toJSStr(buffer_620762309)));
    break BeforeRet;
  } while (false);

  return result_620762310;

}
var elfs_469762158 = to_469762070(parseJson_620762308(makeNimstrLit("[[8550,7983,8330,8883,9575,9300,8453,6367,5770],[6461,5774,5822,5873,7594,7653,6871,7934,6083,4111,7399],[69172],[68718],[7062,9723,4933,8313,8988,9771,8549,10278],[66910],[6014,6309,4072,8155,7481,6771,8686,5980,6754,5761],[36912,27721],[24714,16695,23212],[9313,8444,16375,14666,15215],[5783,8750,4604,7494,5460,6231,4198,5747,7406,7529],[5374,5460,5590,6433,5785,3128,1194,5369,3032,6351,2210,4725,2942,5483],[31132,31889],[5911,6152,2479,3949,3427,5924,6432,6746,6878,5884,3309,3674,2026],[7925,5719,2382,6087,7799,5066,5100,4925,5764,5262,6232],[29248,32773],[2273,8394,9347,4833,9001,8823,7674,1882,9235],[4886,5970,2459,4117,3866,5168,5914,6819,2291,6510,6039,4553,2686],[4372,5930,4010,5308,3557,6006,2054,4331,4274,1501,1532,2900,3255,6106,6061],[5147,5877,1170,4801,4153,3710,1673,5553,5992,5173,4277,1451,5158,3766,3191],[5881,5964,5999,4260,2501,3387,3112,5323,4895,3715,2183,2900,4867,1975,3961],[3664,6265,2609,1884,5972,4086,4523,6108,5073,5407,4410,2353,3627,4617],[3964,6541,3226,3536,6335,6956,3656,4149,6859,4609,4456,2856,3395],[6387,6862,6673,5873,6094,4189,3313,3217,3310,1580,4793,5262,2933],[5561,14448,15742,9477,15244],[9386,18674,17741,14487],[2772,9223,7429,5951,5211,5390,9636,5015,9576],[4839,5218,6044,4868,6466,4237,2814,2210,3365,6128,2713,5229,4600,1466],[8335,9413,5100,7001,4090,6375,9420,6864,3263],[4063,3379,4073,3091,2733,4759,5051,5605,3114,2039,6049,4568,5013,1991,4239],[22021,21472,15888],[6607,6858,3872,5554,5802,1174,5234,6082,6672,4180,1491,4111,1721],[2101,3950,6076,1739,5749,4174,5849,5463,4750,5934,4202,6119,1588,1637],[5619,5474,2892,5214,2677,4596,4314,2790,4749,6478,6865,3755,3747],[28701,30412],[3318,1727,4971,5208,8009,8009,6117,7870,4824,7741,1278],[4781,6068,4342,6091,4340,5890,2973,4214,2884,1782,3622,3240,2185,1947,4634],[6079,7050,13912,13912,12870,4966],[2561,3470,3018,6387,4774,5611,4904,5883,6144,4977,1863,1613,3160,4236],[12710,14353,9583,5759,16081],[2316,3761,4458,4592,5963,2118,6079,2024,3928,4745,2965,1748,2824,5740,5189],[12693,13232,5554,12330,7602,6490],[3626,1064,5420,3228,1444,5662,5600,4544,5177,2309,2186,2638,3164,5703,6079],[4966,6050,2267,2082,3664,1812,4412,6457,5080,3280,6407,3124,5993,2142],[4452,7034,6770,8934,8125,6333,2856,7908,5145],[57499],[23871,33564],[57426],[2437,3160,2215,3949,2996,4494,1615,5174,6019,6055,3186,3229,5248,5656,1847],[5551,2880,4587,7339,7793,8194,5359,8702,6846],[3832,5843,3919,5658,1615,5840,3009,5725,2639,5239,4380,2298,4618,2586],[4718,5897,7178,2031,3409,7218,6794,8699,4119,6928],[3889,7447,1031,6800,4884,6483,1577,7164,2778,6216,3167,5458],[56794],[5436,3448,4345,7430,6934,1717,4553,4683,7091,5718,4289,1140],[3668,3119,4402,5814,4507,3147,4834,1171,4102,5458,4930,5098,1284,5117],[17672,19343,11461,8143],[2931,4457,6108,5058,3393,5132,2076,4461,3353,4568,2182,2493,3285,1592,5370],[8177,12942,13879,2729,11070,7560],[1854,4926,3228,6199,1312,2417,4413,1801,4145,4604,4296,5636,5169,6081],[5722,5243,3506,4961,3587,5584,8571,6724,6901,5278],[2882,3718,2670,2190,1495,3551,5497,3264,6484,6199,2011,4157,5896,6046],[3194,3712,5969,6069,4264,4616,5424,5382,4772,1908,1707,2222,2778,3712],[6118,4821,3134,5633,3091,3618,5465,4116,1577,2776,4592,4923,5812],[16228,13578,12393,13426],[9524,12618,6755,2121,12876,11330],[7860,1341,2546,10857,11814,11301,9280],[7380,9715,5985,9547,9207,6882,4407,1688],[3704,6982,7230,4807,6677,6131,2698,3048,4914,3656,4707],[1243,6663,7560,10078,1589,8782,9184,9149],[1475,1319,6422,2086,1101,2435,1661,6011,5927,4798,4770,4860,4821,6438],[15980,14653,5439,2880,15145],[3038,5447,5010,10502,9033,4127,9385,7438],[4170,3426,2878,4025,3745,4267,2678,6439,1986,3401,1323,4225,6003,5156],[7544,6590,6098,7178,7354,1570,8934,1544,6880],[4661,1018,4383,4852,1090,5644,3953,1204,2819,3500,2749,5615,3939,5118,3128],[3315,18956,13505,17849],[23083,30515],[2517,6446,6777,5881,7923,5523,4904,3018,5737,4826],[6154,6665,7026,11383,13857,8357],[6216,3861,1281,1935,2128,1550,5869,4139,6307,5320,4740,5970,4039],[5816,2375,7279,6266,4691,6941,6754,1496,5536,1911,4220],[2068,1714,6972,5061,6633,4180,5603,5186,6986,3112,5696],[6261,1307,5579,6582,6098,5375,4876,4747,3285,6389,2660],[5874,3960,5490,6056,5222,6205,1153,5491,4156,3921,4369,1195],[5974,3386,2793,4898,2975,3865,5974,3655,3838,1822,3322,1610,5610,3243],[5631,7749,1074,4825,2650,6835,6433,5946,4203,4514,2944],[4084,1491,5988,6646,2061,2083,1761,5146,4656,5620,3959,6133,3161],[4180,3086,5044,1980,5636,2776,5399,3898,1353,4864,5504,5631,3373],[3453,4166,6214,4735,6756,7020,4624,4679,1779,3429,1133,4630],[4887,4197,3782,5889,6735,5729,2783,3170,3062,6874,5479],[3478,4256,1755,3308,1105,2738,4607,3867,2306,3615,2686,5102,5659,3177,4846],[8019,1455,3994,10337,3779,7604,9614,7636],[5507,5947,7455,6774,2836,2126,3098,1685,6404,4302,4508,1739],[13577,14550,5133,11050,7976],[9143,19336,8940,14860],[9653,13620,20041,8914],[2465,6819,3758,7537,1607,3958,2502,7743,1448,6763,7543],[11170,3970,11159,5081,5508,9043,6180],[3154,8490,5069,6268,4530,2929,7829,9000,4835],[3464,4099,2514,6217,2209,6501,5950,3218,4821,3121,4106,4451,1228],[16145,17357,7612,10493],[1679,1745,5214,4118,6052,4962,3633,3355,2768,2857,2124,4280,4754,1535,2400],[3578,5102,3755,2031,6961,6433,6081,2957,1770,1280,4229,7081],[8168,4475,7287,9416,6264,2691,4551,5109,3286],[1540,3601,6238,2433,5286,1272,1567,2425,5797,5222,3213,6021,6519],[4761,21813,24493],[11177,1872,15245,16212,6512],[3315,1937,2698,1647,3083,5874,4801,4649,1311,5306,4655,4981,2325,2130,2261],[20041,15769,6691,8310],[4314,5032,5345,3719,2918,3847,2708,1834,2603,2200,3822,6052,2997,1540,1846],[1831,4702,5322,5424,4620,3951,1275,1074,1767,4751,2512,4367,2623,6175],[9388,11343,5178,2164,10275,6054,5742],[3156,4905,4799,2502,7230,6169,2350,4196,4384,5939,2889,1349],[2394,1604,6133,1886,2648,3636,2998,5510,1422,5184,3436,6317,3481,3109],[2129,2231,2489,5616,1467,2225,5657,4127,6286,5359,4725,1819,5550],[9296,11898,8802,3804,1796,13910],[3229,2998,15582,12963,14718],[11290,1294,2117,13739,9724,11236],[13845,9073,7678,15430,3256],[3976,2654,4849,2090,5774,1173,2645,4282,3014,3082,6723,6860,2129],[2182,4147,2513,4571,1569,2946,1972,3032,3580,5820,4722,3358,4456,2945,1417],[7523,3390,2318,8663,7609,1722,5343,8124,1579,2959],[4172,21931,22824],[3545,4228,7420,10436,5854,10021,7383],[4807,1180,6655,4572,3864,4674,6759,6861,4273,2387,1085,1598],[4937,4124,4119,2485,3358,5815,4338,2249,5615,5378,1533,1035,2194,1521],[12521,14781,2837,18442],[12885,10836,17345,7449],[2815,7505,3875,1236,2028,3022,8262,6240,6295,7060],[4117,5801,4046,2354,3552,4774,2218,4651,4221,6622,3388,2588],[17612,30650],[7116,2820,5625,5143,3055,1554,4279,5644,1908,6292,4492],[1441,3255,5210,1328,1628,3809,2422,3055,4402,2905,2375,2369,5513,4352,3749],[7093,4995,11710,8145,2509,11002,2329],[3967,4866,2889,4428,1896,2064,3350,2802,5240,5626,1206,2169,3757,3481],[6349,5106,1725,4758,5364,3316,4235,4813,4421,1682,2133,3691],[4978,5247,10881,3833,13656,8822],[11849,11080,24418],[11329,35988],[32135,15179],[4090,1110,4663,2618,1587,3417,4401,3837,2593,4503,1746,4797,1821,3502,2592],[6508,4569,2836,7992,2876,4464,5023,2920,3794,6274],[31882,15152],[10312,3810,7818,6172,7615,9201,1937],[13079,12502,8332,12919],[5318,8457,6221,1419,1715,6222,9581,5606,2293],[19168,27638],[10827,4384,3514,12710,12592,2531],[2666,2481,6683,1783,4880,5339,5075,1043,6314,1440,5100,1647,2095],[6226,9901,6735,7602,4045,4643,5047,2329],[3359,1950,3396,7128,1724,6590,5952,2255,1022,5923,4381,2670],[7414,4519,1108,8667,8481,5032,10813],[3015,2463,8928,8067,9196,4077,5189,2392,2574],[18376,8663,11423,7152],[4029,11446,11571,2683,3454,12411],[14058,4268,12789,11917,2470],[4352,3701,5794,4775,1622,2128,1063,1009,1702,4405,4455,1304,5133,1374,2677],[45424],[2819,1623,4195,1981,2908,4730,2621,4136,4824,3588,2979,1583,1776,1845,3772],[3466,9107,2058,1813,2236,8430,2923,7801,7506],[45267],[14561,4204,17338,9054],[5576,23361,16052],[6100,4344,7043,9434,6107,3579,1697,3166,3414],[6489,5442,4307,1773,4716,1220,5407,2997,4763,2629,5102],[23534,21079],[1883,5114,2366,2220,3239,2574,3754,2711,6984,7464,6208],[3956,12204,1708,13838,7704,5066],[1824,7913,3167,2770,6853,5049,8970,3980,3792],[1266,8056,3268,7231,3018,2774,2415,5377,4227,5428,1113],[3059,2276,1441,3886,2204,3853,3910,5347,5630,5721,6630],[5613,1938,5481,3692,5223,1505,3628,1095,4340,2681,5657,1811,1233],[1847,3374,3505,3451,2323,5703,1466,5226,1553,7253,1835,6210],[4698,7755,2595,1730,5954,3714,5023,4167,2202,4679,1165],[6226,7319,12112,6817,8025,2668],[2641,9002,8338,13253,9830],[3926,4456,3783,3058,1752,4944,6732,6587,2578,3490,1730],[9067,6897,4655,5091,2824,7062,1336,1835,3831],[3776,1762,5809,8808,1028,1768,7751,2274,5136,4402],[1888,4764,5673,6832,8312,5569,3874,1831,1742,1953],[9795,2854,6539,1197,7913,6560,1912,5636],[2120,4019,4685,1360,4315,2733,1546,3986,3071,4308,6705,1480,2075],[5715,8382,2666,14581,11008],[1765,3327,5205,4124,2834,5524,1945,4393,3958,1021,4989,1142,1960],[4955,4020,13061,7532,12446],[1360,17274,9730,13453],[1164,4408,7118,7230,1636,5958,2070,2091,3158,6631],[3527,5534,4501,8409,3396,5553,10346],[2207,16017,2824,13752,6355],[1307,5004,2336,7721,1757,5155,4671,2734,4884,5549],[6888,5446,3132,1888,2668,1529,1568,1901,4708,2815,8079],[15038,13852,2993,6765,1799],[1849,4313,9018,5235,5785,3287,1464,6853,2251],[9175,4868,3374,6053,5304,4585,1344,5036],[39362],[12480,5566,21219],[13493,12177,9701,1146,2421],[1168,14381,11380,6522,4822],[3400,6270,6159,1199,6841,1411,2272,2298,8236],[2630,1137,2881,2123,4994,3215,3315,2353,4031,4151,1609,5278],[2082,5860,3018,8157,2087,1462,2164,2651,6380,3549],[37135],[15785,8518,4131,8614],[2122,17054,9678,8169],[10329,26374],[1807,13594,13712,7385],[17869,15266,3313],[2715,7932,12032,10044,3722],[5263,1495,6398,3191,1787,4516,4528,1984,2209,2937,1917],[26031,10122],[1615,2033,1853,3334,10998,5591,10429],[1225,5350,3013,1102,7614,3002,4451,2059,1843,6158],[8056,21295,6331],[4431,3109,3055,1713,1848,4118,1730,2280,1079,3688,1569,2995,4061],[5523,12113,3128,5978,4683,3458],[11595,22943],[16002,11740,6583],[34056],[6708,1285,1573,2512,4161,2397,5196,2829,2105,5197],[16209,17734],[22224,11444],[6154,5064,2106,11402,8462],[3757,4427,4747,2214,3723,1434,7512,1878,3167],[2321,1291,2159,7409,3502,4266,2190,5307,1971,2217],[13286,5182,14123],[32390],[12233,1056,12928,6106],[3759,7106,1671,1596,7855,3616,4858],[19487,10768],[3862,12513,6788,4010,1427,1098],[1583,9915,2518,3285,12248],[5463,10532,13499],[2728,2912,1566,5990,7139,1082,6536,1213],[17286,1875,6596,2739],[28182],[5725,8219,7284,1011,1903,2835],[4827,6451,2666,7916,2321,2258],[26007],[2430,5591,3145,13825],[7673,12780,3682],[15869,8031],[13992,8555],[2090,8624,11777],[15006,4561,2828],[4892,4077,1163,7588],[16712],[16255],[12700,2207],[2121,6314,5463],[12946],[7127,2867],[2104,2166,4813],[7352]]")));
var idx_469762162 = [-20];

function addQuoted_469762433(s_469762435, s_469762435_Idx, x_469762436) {
    addInt_251658457(s_469762435, s_469762435_Idx, x_469762436);

  
}

function collectionToString_469762403(x_469762405, prefix_469762406, separator_469762407, suffix_469762408) {
  var result_469762409 = [[]];

    result_469762409[0] = nimCopy(null, prefix_469762406, NTI33554439);
    var firstElement_469762410 = true;
    Label1: do {
      var value_469762429 = null;
      var value_469762429_Idx = 0;
      var i_469762482 = 0;
      var L_469762483 = (x_469762405).length;
      Label2: do {
          Label3: while (true) {
          if (!(i_469762482 < L_469762483)) break Label3;
            value_469762429 = x_469762405; value_469762429_Idx = i_469762482;
            if (firstElement_469762410) {
            firstElement_469762410 = false;
            }
            else {
            result_469762409[0].push.apply(result_469762409[0], separator_469762407);;
            }
            
            addQuoted_469762433(result_469762409, 0, value_469762429[value_469762429_Idx]);
            i_469762482 += 1;
          }
      } while (false);
    } while (false);
    result_469762409[0].push.apply(result_469762409[0], suffix_469762408);;

  return result_469762409[0];

}

function HEX24_469762399(x_469762401) {
  var result_469762402 = [];

    result_469762402 = nimCopy(null, collectionToString_469762403(x_469762401, makeNimstrLit("@["), makeNimstrLit(", "), makeNimstrLit("]")), NTI33554439);

  return result_469762402;

}

function addQuoted_469762393(s_469762395, s_469762395_Idx, x_469762396) {
    s_469762395[s_469762395_Idx].push.apply(s_469762395[s_469762395_Idx], HEX24_469762399(x_469762396));;

  
}

function collectionToString_469762359(x_469762361, prefix_469762362, separator_469762363, suffix_469762364) {
  var result_469762365 = [[]];

    result_469762365[0] = nimCopy(null, prefix_469762362, NTI33554439);
    var firstElement_469762366 = true;
    Label1: do {
      var value_469762386 = null;
      var value_469762386_Idx = 0;
      var i_469762477 = 0;
      var L_469762478 = (x_469762361).length;
      Label2: do {
          Label3: while (true) {
          if (!(i_469762477 < L_469762478)) break Label3;
            value_469762386 = x_469762361; value_469762386_Idx = i_469762477;
            if (firstElement_469762366) {
            firstElement_469762366 = false;
            }
            else {
            result_469762365[0].push.apply(result_469762365[0], separator_469762363);;
            }
            
            addQuoted_469762393(result_469762365, 0, value_469762386[value_469762386_Idx]);
            i_469762477 += 1;
          }
      } while (false);
    } while (false);
    result_469762365[0].push.apply(result_469762365[0], suffix_469762364);;

  return result_469762365[0];

}

function HEX24_469762355(x_469762357) {
  var result_469762358 = [];

    result_469762358 = nimCopy(null, collectionToString_469762359(x_469762357, makeNimstrLit("@["), makeNimstrLit(", "), makeNimstrLit("]")), NTI33554439);

  return result_469762358;

}

function toFloat_1124073478(n_1124073479) {
  var result_1124073480 = 0.0;

    result_1124073480 = n_1124073479;

  return result_1124073480;

}

function setup() {
    createCanvas(800.0, toFloat_1124073478((2 * (elfs_469762158).length)));
    background(toJSStr(colDark_1275068417));
    frameRate(50.0);
    noStroke();

  
}

function showElf_469762223(x_469762224, y_469762225, food_469762226, colors_469762227) {
    push();
    translate(x_469762224, y_469762225);
    Label1: do {
      var i_469762249 = 0;
      var f_469762250 = 0;
      var i_469762487 = 0;
      var L_469762488 = (food_469762226).length;
      Label2: do {
          Label3: while (true) {
          if (!(i_469762487 < L_469762488)) break Label3;
            i_469762249 = i_469762487;
            f_469762250 = food_469762226[i_469762487];
            fill(toJSStr(colors_469762227[Math.trunc(i_469762249 % (colors_469762227).length)]));
            rect(0.0, 0.0, (toFloat_1124073478(f_469762250) / 100.0), 2.0);
            translate((toFloat_1124073478(f_469762250) / 100.0), 0.0);
            i_469762487 += 1;
          }
      } while (false);
    } while (false);
    pop();

  
}

function draw() {
    if ((idx_469762162[0] < (elfs_469762158).length)) {
    if ((0 <= idx_469762162[0])) {
    showElf_469762223(0.0, toFloat_1124073478((2 * idx_469762162[0])), elfs_469762158[idx_469762162[0]], palettes_1275068488[Math.trunc(idx_469762162[0] % 14)]);
    }
    
    idx_469762162[0] += 1;
    }
    else {
      idx_469762162[0] += 1;
      if ((((elfs_469762158).length + 100) < idx_469762162[0])) {
      background(toJSStr(colDark_1275068417));
      idx_469762162[0] = -60;
      }
      
    }
    

  
}

function keyPressed() {
    if (eqStrings(cstrToNimstr(key), makeNimstrLit("s"))) {
    saveGif("day01", 3.0);
    }
    

  
}
rawEcho(HEX24_469762355(elfs_469762158));
</script>
</main>
<footer>
<hr>
<div class="nb-box">
  <span><span class="nb-small">made with <a href="https://pietroppeter.github.io/nimib/">nimib üê≥</a></span></span>
  <span></span>
  <span><button class="nb-small" id="show" onclick="toggleSourceDisplay()">Show Source</button></span>
</div>
</footer>
<section id="source">
<pre><code class="nim hljs"><span class="hljs-keyword">import</span> nimib, aoc22, p5
<span class="hljs-keyword">let</span> day = <span class="hljs-type">Day</span>(
  num: <span class="hljs-number">1</span>,
  title: <span class="hljs-string">&quot;Calorie Counting&quot;</span>,
  summary: <span class="hljs-string">&quot;&quot;</span>
)

nbInit
nbUseP5
nbJsFromCode:
  <span class="hljs-keyword">import</span> p5aoc
nb.darkMode
nbText: day.mdTitle
nbText: <span class="hljs-string">&quot;&quot;&quot;
1. [Part 1](#part1)
2. [Part 2](#part2)
3. [Seen around](#around)
4. [Visualizationüå∏](#viz)

First day of new year of advent of code, happy to be back here having fun with [nim]
and [nimib] and blogging about it. The idea for this year is to try and make visualization
with [p5nim].

Another thing I will be doing is using [batteries] for importing common stdlib modules.
This is a nice convenience module that was supposed to improve on pattern of doing `include prelude`
but it was [decided not to] put it in stdlib and you can now install it with [nimble].

[decided not to]: https://github.com/nim-lang/Nim/pull/20041
&quot;&quot;&quot;</span> &amp; mdRefs
nbCode:
  <span class="hljs-keyword">import</span> batteries
nbText: <span class="hljs-string">&quot;&quot;&quot;### &lt;a name=&quot;part1&quot;&gt;Part 1&lt;/a&gt;
Solving any puzzle you take a lot of micro decision.
Often I like to separate parsing and processing, but in cases like today
it is very convenient to do both at once:
&quot;&quot;&quot;</span>
<span class="hljs-comment">#nbCodeAnd(nbJsFromCode):</span>
nbCode:
  <span class="hljs-keyword">var</span>
    elfs: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">seq</span>[<span class="hljs-built_in">int</span>]]
    elf: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">int</span>]
    maxCalories: <span class="hljs-built_in">int</span>

  <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> day.filename.lines:
    <span class="hljs-keyword">if</span> len(line.strip) &gt; <span class="hljs-number">0</span>:
      elf.add parseInt(line)
    <span class="hljs-keyword">else</span>:
      elfs.add elf
      <span class="hljs-keyword">if</span> sum(elf) &gt; maxCalories:
        maxCalories = sum(elf)
      elf = @[]
  <span class="hljs-comment"># at the end I still need to add last elf</span>
  <span class="hljs-keyword">if</span> len(elf) &gt; <span class="hljs-number">0</span>:
    elfs.add elf
    <span class="hljs-comment"># and maybe he is the one bringing most calories</span>
    <span class="hljs-keyword">if</span> sum(elf) &gt; maxCalories:
      maxCalories = sum(elf)

  <span class="hljs-keyword">echo</span> maxCalories
gotTheStar
nbText: <span class="hljs-string">&quot;&quot;&quot;### &lt;a name=&quot;part2&quot;&gt;Part 2&lt;/a&gt;
Easiest (not most performant) to get top three is to sort:
&quot;&quot;&quot;</span>
nbCode:
  sort(elfs, ((elfA, elfB) =&gt; sum(elfA) - sum(elfB)), order=<span class="hljs-type">SortOrder</span>.<span class="hljs-type">Descending</span>)

  <span class="hljs-keyword">echo</span> sum elfs[<span class="hljs-number">0.</span>.<span class="hljs-number">2</span>].mapIt(sum it)
gotTheStar
nbText: <span class="hljs-string">&quot;&quot;&quot;### &lt;a name=&quot;around&quot;&gt;Seen around&lt;/a&gt;
Section &quot;seen around&quot; is where I gather interesting stuff seen around about advent of code for today:

- [daily solution megathread](https://www.reddit.com/r/adventofcode/comments/z9ezjb/2022_day_1_solutions/) to post your solution (I did!).
seen a couple of people doing it in Nim
- community [fun event thread](https://www.reddit.com/r/adventofcode/comments/z9he28/advent_of_code_2022_mistiltoe_elfucation/)
(I will have to participate with p5nim project)
- unofficial participant [survey](https://www.reddit.com/r/adventofcode/comments/z9eoer/unofficial_aoc_2022_participant_survey/),
do it and mention you are using Nim! (I did complete the survey)
- a nice [visualization](https://www.reddit.com/r/adventofcode/comments/z9kk1m/2022_day_1_adding_up_the_calories/)
(apparently done in PyCairo)
- eric wastl aka r/topaz aka creator of adventofcode is worried about user agents
and has [some advice to give](https://www.reddit.com/r/adventofcode/comments/z9dhtd/please_include_your_contact_info_in_the_useragent/)
- this year we will have lots of AI generated visualizations here is [one](https://www.reddit.com/r/adventofcode/comments/z9g0i0/ai_imagine_advent_of_code_2022_day_1/)
and [another (with demons)](https://www.reddit.com/r/adventofcode/comments/z9iz9t/i_may_have_mistyped_santa/)
- I did also post [my visualization](https://www.reddit.com/r/adventofcode/comments/za0xyr/2022_day_1nim_visualization_with_nim_bindings_to/)
on the subreddit
- this year are back the most beatiful nim solutions, the ones by [MichalMarsalek](https://github.com/MichalMarsalek/Advent-of-code/blob/master/2022/Nim/day1.nim)
- PMunch is streaming again this year! you can watch it [here](https://www.twitch.tv/videos/1667530842)
(starts around 3:40, I am listening to it now)
- someone is solving aoc with [github copilot](https://twitter.com/TheZachMueller/status/1598342197816004608)
(the idea comes from a nice discord of data professionals emigrated from twitter, you can find the prompt in the #advent-of-code chat there [invite](https://discord.gg/jW52MxX5))
- will Peter Norvig do advent of code this year? has not started committing yet, if he does
it will appear in his [pytudes repo](https://github.com/norvig/pytudes)
- Jari Komppa last year did a great series of gifs for solutions, he is going
at it [this year](https://twitter.com/Sol_HSA/status/1598192914781597696?s=20&amp;t=NzB5qlmO7tj5HRiSNPGdeQ) too
&quot;&quot;&quot;</span>
nbText: <span class="hljs-string">&quot;&quot;&quot;### Visualization

Let's look at total food and number of elfs before visualizing.
&quot;&quot;&quot;</span>
nbCode:
  <span class="hljs-keyword">echo</span> sum elfs.mapIt(sum it)
  <span class="hljs-keyword">echo</span> len(elfs)

<span class="hljs-keyword">template</span> myJsWithCaptures(body: <span class="hljs-built_in">untyped</span>) =
  nbJsFromCode(elfs):
    body

nbText: <span class="hljs-string">&quot;&quot;&quot;
Here is a very simple visualization:
  - plot a rectangle for every elf, with length proportional to the food
  - every piece of food is colored with a color extracted from a palette
  - list of palettes is taken from [takawo]
  - I also wait a moment before starting and wait also at the end

[takawo]: https://openprocessing.org/sketch/1751402
&quot;&quot;&quot;</span>
nbCodeDisplay(myJsWithCaptures):
  <span class="hljs-keyword">const</span>
    ratio = <span class="hljs-number">100.0</span>
    hElf = <span class="hljs-number">2</span>
    idxWait = <span class="hljs-number">100</span>
  <span class="hljs-keyword">var</span> idx = -<span class="hljs-number">20</span>

  <span class="hljs-keyword">proc</span> showElf(x, y: <span class="hljs-built_in">float</span>, food: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">int</span>], colors: <span class="hljs-built_in">seq</span>[<span class="hljs-built_in">string</span>]) =
    push()
    translate(x, y)
    <span class="hljs-keyword">for</span> i, f <span class="hljs-keyword">in</span> food:
      fill(colors[i <span class="hljs-keyword">mod</span> colors.len])
      rect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, f / ratio, hElf)
      translate(f / ratio, <span class="hljs-number">0</span>)
    pop()

  <span class="hljs-keyword">echo</span> elfs
  setup:
    createCanvas(<span class="hljs-number">800</span>, hElf*len(elfs))
    <span class="hljs-comment">#createCanvas(800, 800)</span>
    background(colDark)
    frameRate(<span class="hljs-number">50</span>)
    noStroke()
  draw:
    <span class="hljs-keyword">if</span> idx &lt; elfs.len:
      <span class="hljs-keyword">if</span> idx &gt;= <span class="hljs-number">0</span>: <span class="hljs-comment"># wait before starting</span>
        showElf(<span class="hljs-number">0</span>, hElf*idx, elfs[idx], palettes[idx <span class="hljs-keyword">mod</span> len palettes])
      inc idx
    <span class="hljs-keyword">else</span>:
      <span class="hljs-comment"># wait a moment</span>
      inc idx
      <span class="hljs-keyword">if</span> idx &gt; elfs.len + idxWait:
        background(colDark)
        idx = -<span class="hljs-number">60</span>
nbRawHtml: <span class="hljs-string">&quot;&lt;a name=</span><span class="hljs-meta">\&quot;</span><span class="hljs-string">viz</span><span class="hljs-meta">\&quot;</span><span class="hljs-string">&gt;&lt;/a&gt;&quot;</span>
nbJsFromCode():
  keyPressed:
    <span class="hljs-keyword">if</span> $key == <span class="hljs-string">&quot;s&quot;</span>:
      saveGif(<span class="hljs-string">&quot;day01&quot;</span>, <span class="hljs-number">3</span>)
nbText: <span class="hljs-string">&quot;for an older version of this visualization go [here](day01_viz1.html)&quot;</span>
nbSave
<span class="hljs-comment">#[
this does not work, issue with capturing variables?

nbJsFromCode(elfs):
  echo elfs
- [ ] investigate and produce minimial repr example (and submit issue to nimib)

another issue: SIGSEGV: Illegal storage access. (Attempt to read from nil?)

-&gt; this might be a bug in orc (in my current nim 1.6.6)! if I remove orc it works!

# saving gif does not work
]#</span> </code></pre>
</section><script>
function toggleSourceDisplay() {
  var btn = document.getElementById("show")
  var source = document.getElementById("source");
  if (btn.innerHTML=="Show Source") {
    btn.innerHTML = "Hide Source";
    source.style.display = "block";
  } else {
    btn.innerHTML = "Show Source";
    source.style.display = "none";
  }
}
</script></body>
</html>