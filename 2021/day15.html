<!DOCTYPE html>
<html lang="en-us">
<head>
  <title>2021/day15.nim</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2280%22>üê≥</text></svg>">
  <meta content="text/html; charset=utf-8" http-equiv="content-type">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link rel='stylesheet' href='https://unpkg.com/normalize.css/'>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/dark.min.css">
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/pietroppeter/nimib/assets/androidstudio.css'>
  <style>
.nb-box {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.nb-small {
  font-size: 0.8rem;
}
button.nb-small {
  float: right;
  padding: 2px;
  padding-right: 5px;
  padding-left: 5px;
}
section#source {
  display:none
}
</style>
  
  <script async defer data-domain="pietroppeter.github.io/adventofnim" src="https://plausible.io/js/plausible.js"></script>
  <style>
    a {
        text-decoration: none;
        color: #009900;
    }
  
    a:hover {
        color: #99ff99;
    }
  
    em {
        color: #ffffff;
        font-style: normal;
        text-shadow: 0 0 5px #ffffff;
    }
  
    em.star {
      font-style: normal;
      color: #ffff66;
      text-shadow: 0 0 5px #ffff66;
    }
  </style>
</head>
<body>
<header>
<div class="nb-box">
  <span><a href="..">üè°</a></span>
  <span><code>2021/day15.nim</code></span>
  <span><a href="https://github.com/pietroppeter/adventofnim"><svg aria-hidden="true" width="1.2em" height="1.2em" style="vertical-align: middle; fill: #fff" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a></span>
</div>
<hr>
</header><main>
<h2>Day 15: <a href="https://adventofcode.com/2021/day/15">Chiton</a></h2>
<p>Today is about path search on a grid. I tend to struggle with these
since I never properly studied the theory.</p>
<h3>Part 1</h3>
<p>We need to go from top left to bottom right minimizing sum of risk.
My strategy will be to create from given grid a new grid that
at every &quot;node&quot; (it usually pays to think of these problems in terms of graphs),
will tell me the direction I should come from in order to minimize the risk and
get there. The final path will be found by following directions from bottom right.</p>
<p>Here are the inputs:</p>
<pre><code class="nim hljs"><span class="hljs-keyword">let</span>
  testInput = <span class="hljs-string">&quot;&quot;&quot;
1163751742
1381373672
2136511328
3694931569
7463417111
1319128137
1359912421
3125421639
1293138521
2311944581&quot;&quot;&quot;</span>
  puzzleInput = readFile(<span class="hljs-string">&quot;2021/input15.txt&quot;</span>)</code></pre>
<p>I will be using grid code from my Day09 (no blogpost published),
copying and pasting here the useful bits (I will need to think of an ergonomic
way to import from a notebook). I am also fine with having a sentinel value
for stuff outside the grid that is a high value.</p>
<pre><code class="nim hljs"><span class="hljs-keyword">type</span>
  <span class="hljs-type">Coord</span> = <span class="hljs-keyword">tuple</span>[x, y: <span class="hljs-built_in">int</span>]
  <span class="hljs-type">Grid</span>[<span class="hljs-type">T</span>] = <span class="hljs-keyword">object</span>
    data: <span class="hljs-built_in">seq</span>[<span class="hljs-type">T</span>]
    yLen, xLen: <span class="hljs-built_in">int</span>
    sentinel: <span class="hljs-type">T</span>  <span class="hljs-comment"># value for outside the grid</span>
  <span class="hljs-type">GridInt</span> = <span class="hljs-type">Grid</span>[<span class="hljs-built_in">int</span>]
  <span class="hljs-type">Dir</span> = <span class="hljs-keyword">enum</span>
    right, down, left, up

<span class="hljs-keyword">func</span> isOutside[<span class="hljs-type">T</span>](c: <span class="hljs-type">Coord</span>, g: <span class="hljs-type">Grid</span>[<span class="hljs-type">T</span>]): <span class="hljs-built_in">bool</span> =
  c.x &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> c.x &gt;= g.xLen <span class="hljs-keyword">or</span> c.y &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> c.y &gt;= g.yLen

<span class="hljs-keyword">func</span> toIndex[<span class="hljs-type">T</span>](g: <span class="hljs-type">Grid</span>[<span class="hljs-type">T</span>], c: <span class="hljs-type">Coord</span>): <span class="hljs-built_in">int</span> =
  <span class="hljs-keyword">if</span> c.isOutside(g):
    -<span class="hljs-number">1</span>
  <span class="hljs-keyword">else</span>:
    c.y*g.xLen + c.x

<span class="hljs-keyword">func</span> `[]`[<span class="hljs-type">T</span>](g: <span class="hljs-type">Grid</span>[<span class="hljs-type">T</span>], c: <span class="hljs-type">Coord</span>): <span class="hljs-type">T</span> =
  <span class="hljs-keyword">let</span> i = g.toIndex(c)
  <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">0</span>:
    g.sentinel
  <span class="hljs-keyword">else</span>:
    g.data[i]

<span class="hljs-keyword">func</span> parseInt(c: <span class="hljs-built_in">char</span>): <span class="hljs-built_in">int</span> =
  <span class="hljs-literal">result</span> = ord(c) - ord(<span class="hljs-string">'0'</span>)
  <span class="hljs-keyword">assert</span> <span class="hljs-literal">result</span> &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-literal">result</span> &lt;= <span class="hljs-number">9</span>

<span class="hljs-keyword">func</span> parse(text: <span class="hljs-built_in">string</span>): <span class="hljs-type">GridInt</span> =
  <span class="hljs-comment"># result.data = newSeqOfCap(text.len)</span>
  <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> text.strip.splitLines:
    <span class="hljs-literal">result</span>.data.add line.toSeq.map(parseInt)
    inc <span class="hljs-literal">result</span>.yLen
    <span class="hljs-keyword">if</span> <span class="hljs-literal">result</span>.xLen == <span class="hljs-number">0</span>:
      <span class="hljs-literal">result</span>.xLen = line.len
    <span class="hljs-keyword">else</span>:
      <span class="hljs-keyword">assert</span> line.len == <span class="hljs-literal">result</span>.xLen
  <span class="hljs-literal">result</span>.sentinel = <span class="hljs-built_in">int</span>.<span class="hljs-keyword">high</span>

<span class="hljs-keyword">iterator</span> coords[<span class="hljs-type">T</span>](g: <span class="hljs-type">Grid</span>[<span class="hljs-type">T</span>]): <span class="hljs-type">Coord</span> =
  <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> ..&lt; g.yLen:
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> ..&lt; g.xLen:
      <span class="hljs-keyword">yield</span> (x, y)

<span class="hljs-keyword">func</span> `+`(c: <span class="hljs-type">Coord</span>, dir: <span class="hljs-type">Dir</span>): <span class="hljs-type">Coord</span> =
  <span class="hljs-keyword">case</span> dir
  <span class="hljs-keyword">of</span> right:
    (c.x + <span class="hljs-number">1</span>, c.y)
  <span class="hljs-keyword">of</span> down:
    (c.x, c.y + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">of</span> left:
    (c.x - <span class="hljs-number">1</span>, c.y)
  <span class="hljs-keyword">of</span> up:
    (c.x, c.y - <span class="hljs-number">1</span>)</code></pre>
<p>Let's use it to parse inputs:</p>
<pre><code class="nim hljs"><span class="hljs-keyword">let</span>
  testGrid = parse testInput
  puzzleGrid = parse puzzleInput
dump (testGrid.xlen, testGrid.ylen)
dump (puzzleGrid.xlen, puzzleGrid.ylen)
dump testGrid.sentinel</code></pre>
<pre><samp>(testGrid.xlen, testGrid.ylen) = (10, 10)
(puzzleGrid.xlen, puzzleGrid.ylen) = (100, 100)
testGrid.sentinel = 9223372036854775807
</samp></pre>
<p>I am not using a <code>GridDiff</code> (I did not copy related code),
I will be using a <code>GridRisk</code> which will tell
me minimal total risk up to here and best direction I should come from.</p>
<p>I will also use show functions to debug.</p>
<pre><code class="nim hljs"><span class="hljs-keyword">type</span>
  <span class="hljs-type">Risk</span> = <span class="hljs-keyword">tuple</span>[risk: <span class="hljs-built_in">int</span>, dir: <span class="hljs-type">Dir</span>]
  <span class="hljs-type">GridRisk</span> = <span class="hljs-type">Grid</span>[<span class="hljs-type">Risk</span>]

<span class="hljs-keyword">func</span> show(g: <span class="hljs-type">GridInt</span>): <span class="hljs-built_in">string</span> =
  <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> g.coords:
    <span class="hljs-literal">result</span>.add $g[c]
    <span class="hljs-keyword">if</span> c.x == g.xLen - <span class="hljs-number">1</span>:
      <span class="hljs-literal">result</span>.add <span class="hljs-string">'\n'</span>

<span class="hljs-keyword">func</span> show(g: <span class="hljs-type">GridRisk</span>, paddingCount=<span class="hljs-number">4</span>): <span class="hljs-built_in">string</span> =
  <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> g.coords:
    <span class="hljs-literal">result</span>.add align($(g[c].risk), paddingCount)
    <span class="hljs-keyword">if</span> c.x == g.xLen - <span class="hljs-number">1</span>:
      <span class="hljs-literal">result</span>.add <span class="hljs-string">'\n'</span>

<span class="hljs-keyword">echo</span> show testGrid</code></pre>
<pre><samp>1163751742
1381373672
2136511328
3694931569
7463417111
1319128137
1359912421
3125421639
1293138521
2311944581

</samp></pre>
<p>Here is the heart of the problem. Key for this is realizing
how to compute incrementally compute the risk.</p>
<pre><code class="nim hljs"><span class="hljs-keyword">func</span> computeRisk(g: <span class="hljs-type">GridInt</span>, gr: <span class="hljs-type">GridRisk</span>, c: <span class="hljs-type">Coord</span>): <span class="hljs-type">Risk</span> =
  <span class="hljs-comment">## Computes Risk at Coord assuming Risk has been computed</span>
  <span class="hljs-comment">## for cells on the left and above</span>
  <span class="hljs-keyword">let</span>
    riskUp = gr[c + up].risk + g[c]
    riskLeft = gr[c + left].risk + g[c]
  <span class="hljs-comment">#debugEcho &quot;computeRisk for c: &quot;, c</span>
  <span class="hljs-comment">#debugEcho &quot;  riskUp: &quot;, riskUp</span>
  <span class="hljs-comment">#debugEcho &quot;  riskLeft: &quot;, riskLeft</span>
  <span class="hljs-keyword">if</span> riskUp &lt;= riskLeft:
    (riskUp, up)
  <span class="hljs-keyword">else</span>:
    (riskLeft, left)

<span class="hljs-keyword">func</span> computeGridRisk(g: <span class="hljs-type">GridInt</span>): <span class="hljs-type">GridRisk</span> =
  <span class="hljs-literal">result</span>.xLen = g.xLen
  <span class="hljs-literal">result</span>.yLen = g.ylen
  <span class="hljs-literal">result</span>.sentinel = (g.sentinel - <span class="hljs-number">10</span>, up) <span class="hljs-comment"># forgot this line on first try</span>
  <span class="hljs-comment"># need to do - 10 to avoid overflow</span>
  <span class="hljs-literal">result</span>.data = @[(<span class="hljs-number">0</span>, up)]  <span class="hljs-comment"># risk for initial position does not count</span>
  <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> g.coords:
    <span class="hljs-keyword">if</span> c == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>): <span class="hljs-keyword">continue</span>
    <span class="hljs-literal">result</span>.data.add g.computeRisk(<span class="hljs-literal">result</span>, c)

<span class="hljs-keyword">func</span> part1(gr: <span class="hljs-type">GridRisk</span>): <span class="hljs-built_in">int</span> =
  gr[(gr.xLen - <span class="hljs-number">1</span>, gr.yLen - <span class="hljs-number">1</span>)].risk

<span class="hljs-keyword">let</span>
  testGridRisk = computeGridRisk testGrid
  puzzleGridRisk = computeGridRisk puzzleGrid

<span class="hljs-keyword">echo</span> show testGridRisk

dump part1 testGridRisk
dump part1 puzzleGridRisk <span class="hljs-comment"># 719 wrong</span>

<span class="hljs-keyword">echo</span> show puzzleGridRisk

<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;</span><span class="hljs-meta">\n</span><span class="hljs-meta">\n</span><span class="hljs-string">&quot;</span>, show puzzleGrid</code></pre>
<pre><samp>   0   1   7  10  17  22  23  30  34  36
   1   4  12  11  14  21  24  30  37  38
   3   4   7  13  18  19  20  23  25  33
   6  10  16  17  26  22  21  26  31  40
  13  14  20  20  24  23  28  27  28  29
  14  17  18  27  25  25  33  28  31  36
  15  18  23  32  34  26  28  32  33  34
  18  19  21  26  30  28  29  35  36  43
  19  21  30  29  30  31  37  40  38  39
  21  24  25  26  35  35  39  44  46  40

part1 testGridRisk = 40
part1 puzzleGridRisk = 719
   0   8  13  14  15  23  25  34  35  43  46  47  54  61  63  72  81  89  93 101 110 114 118 125 134 143 152 160 169 170 179 185 188 197 202 210 218 220 228 235 239 248 257 266 271 272 274 276 285 292 300 306 315 323 328 336 339 348 356 362 371 376 379 380 389 397 402 403 410 413 421 425 434 435 441 447 456 462 466 467 474 480 484 489 490 497 505 514 518 521 525 533 542 544 545 554 563 571 580 588
   9  12  14  20  24  32  29  38  39  45  49  55  55  62  70  79  84  85  91  98 107 116 117 126 130 136 144 146 155 163 169 170 175 183 188 195 199 206 214 217 220 223 225 226 234 242 251 256 265 272 278 286 289 298 305 309 310 316 325 333 334 336 342 351 354 358 367 373 378 383 389 394 401 410 416 425 432 433 436 442 450 452 460 468 469 474 483 489 490 499 502 508 511 520 529 538 543 549 557 558
  12  19  23  26  32  40  35  44  48  51  57  61  64  70  78  80  86  87  96 105 114 122 118 121 123 132 133 138 147 154 157 166 174 183 188 192 200 207 215 221 228 229 232 235 242 247 256 265 273 281 284 287 293 302 303 307 315 324 332 337 337 345 345 354 362 367 376 375 382 389 398 395 404 413 421 429 437 438 444 446 447 454 463 472 470 478 487 496 499 507 503 504 513 521 528 529 538 547 554 561
  21  21  25  33  33  41  40  41  44  53  55  61  62  69  78  86  92  96 101 108 109 117 126 129 129 136 140 144 151 159 158 167 175 184 185 189 198 202 206 208 214 221 224 226 227 229 236 243 247 252 261 270 277 286 291 292 300 308 310 317 326 330 336 344 345 347 348 355 363 370 379 386 388 396 405 414 423 429 438 444 453 459 468 475 479 486 491 497 502 510 508 513 514 515 524 528 537 540 549 557
  27  23  32  41  37  44  43  48  51  60  60  66  68  69  71  76  85  86  87  95  96  99 108 109 114 120 128 130 131 134 140 149 158 165 166 175 184 191 192 200 202 210 217 226 228 236 237 243 252 260 269 278 280 289 296 301 305 306 308 312 320 329 336 340 341 349 353 362 363 367 368 377 380 388 392 399 404 410 418 427 432 433 442 451 459 466 471 474 476 483 492 493 502 505 514 519 521 529 533 542
  35  24  28  36  38  46  49  57  58  62  61  62  67  68  76  77  85  88  94  97 105 103 110 115 123 125 134 139 132 135 144 152 161 162 171 178 179 188 195 203 211 219 222 231 237 245 242 245 250 257 260 269 271 277 285 294 300 309 316 319 328 331 332 341 345 351 358 362 371 373 377 378 380 389 398 406 412 416 417 418 425 426 435 437 445 454 463 471 477 486 487 493 498 507 508 517 525 534 541 550
  42  31  29  33  39  47  54  63  66  64  69  67  71  74  83  86  92  93  99 105 106 112 114 117 124 131 132 133 136 143 151 159 162 171 180 180 188 191 194 201 208 209 217 226 233 241 250 249 250 251 260 269 278 284 293 301 301 303 305 312 321 326 329 336 338 343 352 355 357 358 367 368 372 379 388 397 402 411 418 421 425 430 439 439 446 448 450 459 468 476 482 484 485 486 495 504 508 513 517 526
  43  39  34  42  40  49  50  57  63  65  66  67  74  77  82  85  92 101 108 113 112 113 121 125 132 132 141 138 145 150 153 159 160 163 171 180 188 193 202 205 213 210 211 216 225 230 237 246 255 258 259 268 272 274 281 290 297 301 304 313 314 323 326 335 339 346 347 356 358 367 370 372 381 383 389 395 404 412 417 425 431 435 444 446 448 457 459 463 467 470 477 485 493 490 499 506 512 521 518 526
  47  46  42  51  49  51  54  63  72  71  71  75  76  85  91  88  97 106 108 116 121 122 130 130 138 141 150 146 148 157 161 168 169 166 171 179 186 192 194 195 203 212 220 221 230 239 244 252 254 263 263 272 274 283 290 291 300 304 312 318 321 330 333 335 343 347 355 364 367 375 375 381 383 392 397 402 411 420 419 425 429 430 438 441 447 449 457 458 459 463 465 472 481 490 499 507 514 515 524 525
  56  52  50  55  52  53  55  64  72  72  78  84  84  91  96  97  98 105 109 118 126 131 131 133 141 148 157 147 151 160 169 176 177 173 172 181 189 196 200 198 206 215 216 225 234 238 247 256 256 262 270 279 283 290 293 298 305 310 313 322 328 334 341 338 343 350 359 368 372 380 384 390 389 397 406 409 418 419 426 429 434 434 441 447 456 457 465 463 465 467 474 476 480 488 496 500 506 515 524 532
  62  59  58  64  53  62  56  58  65  69  71  72  75  78  82  91  99 108 116 122 125 132 139 142 148 157 161 156 160 168 175 181 186 174 178 182 184 193 202 207 207 209 210 219 227 232 241 242 244 246 253 261 267 273 282 286 295 304 308 317 324 326 335 339 345 348 349 358 365 373 381 388 397 406 414 418 424 427 433 438 442 442 448 454 456 461 470 470 473 476 483 480 488 497 499 508 514 522 527 530
  70  67  67  73  58  62  57  58  66  73  80  75  81  84  90  97 106 114 120 127 131 135 144 150 149 150 157 160 161 164 173 174 176 176 184 190 185 194 199 208 216 215 211 219 220 226 235 243 246 254 261 266 270 279 282 283 292 301 307 315 320 329 332 341 350 353 350 352 358 363 369 378 386 387 389 391 399 406 413 420 427 435 444 448 454 455 462 467 468 473 482 489 489 497 502 504 512 521 524 533
  79  76  72  74  64  71  66  67  74  79  83  78  87  93  99 102 108 111 116 124 133 142 150 159 150 152 156 162 162 164 170 177 185 185 191 195 187 196 204 210 217 223 214 223 221 230 239 248 251 259 265 271 279 281 282 290 291 292 294 299 306 314 323 331 339 348 351 352 356 365 372 378 387 396 394 395 399 405 408 411 417 426 430 437 445 454 462 471 477 482 489 497 494 496 505 513 520 525 525 528
  88  85  75  75  68  70  71  75  83  80  85  86  87  95 104 111 109 118 118 121 129 130 139 143 152 154 161 163 168 165 170 177 185 193 194 196 194 198 205 213 222 231 222 224 224 233 236 240 244 251 260 261 270 271 272 279 280 284 292 294 302 310 319 325 327 333 338 344 351 352 356 359 361 366 372 381 382 391 399 400 408 417 424 431 435 442 448 450 459 468 473 482 491 498 506 507 513 522 531 537
  96  90  83  76  74  71  79  82  90  84  93  88  94  97 100 106 110 119 125 130 138 139 141 143 152 161 170 168 174 174 177 184 193 199 195 204 199 207 206 214 217 226 225 232 231 238 244 241 249 258 265 267 274 279 279 284 287 290 296 295 301 310 312 319 325 334 343 344 348 349 358 363 369 367 369 376 385 387 395 404 405 412 421 430 436 444 447 456 460 469 478 485 491 500 508 516 522 524 531 537
 104  93  89  85  82  76  84  88  94  93 102  92  94 103 103 110 119 124 129 138 139 141 143 144 145 153 154 160 164 168 170 176 185 194 201 208 201 207 214 217 226 230 226 234 240 242 245 250 255 259 261 268 275 281 280 287 293 297 299 303 306 315 321 320 329 337 345 353 349 358 359 364 373 369 378 385 387 388 396 405 406 409 412 420 425 433 434 441 449 458 466 468 477 486 490 495 496 498 500 505
 110  98  98  94  90  82  86  95  95  97 106 101 102 111 106 115 119 120 122 129 137 146 152 148 154 157 163 167 167 176 179 181 186 195 201 209 207 214 222 223 224 233 235 240 245 246 247 253 262 265 270 273 282 287 288 291 297 304 305 304 306 310 311 320 326 329 337 346 353 358 365 373 382 374 382 389 388 396 398 406 409 418 418 426 434 439 435 440 443 448 452 454 462 470 475 476 483 489 497 504
 114 101 100  98  97  88  91  96 102 105 106 108 111 120 109 118 119 120 122 131 139 146 155 149 156 164 164 169 176 180 184 184 191 198 206 212 216 215 224 228 228 233 237 241 250 251 256 258 267 274 279 280 282 291 289 298 301 310 310 305 312 315 313 314 320 329 338 344 353 354 363 372 373 378 383 387 393 402 405 411 411 415 416 425 434 439 443 449 452 451 460 461 469 478 479 478 484 490 497 503
 122 110 109 106 106  92  94 103 103 110 112 114 117 119 118 125 128 129 123 130 133 137 143 149 150 159 163 169 170 178 183 191 196 202 208 217 218 224 231 237 234 240 242 249 253 256 265 264 266 274 279 285 290 294 298 301 305 314 312 313 321 324 322 319 327 330 335 344 350 359 364 366 373 382 388 388 393 399 403 408 417 423 421 429 435 436 444 453 454 460 469 462 471 478 480 481 490 496 500 509
 124 114 116 110 109  96 103 112 112 118 119 119 126 120 120 125 134 131 132 138 135 139 147 156 159 164 172 175 171 177 186 192 201 210 212 221 226 225 234 238 243 242 251 258 259 265 272 272 275 278 287 290 299 301 299 308 313 322 318 322 324 327 327 322 325 326 335 344 352 361 368 375 381 386 394 397 402 404 412 417 426 427 430 438 442 437 446 447 455 464 470 469 476 481 482 488 497 502 506 512
 133 117 125 117 117  98 101 104 105 106 115 124 126 128 124 131 133 140 140 147 144 148 150 151 156 159 160 162 168 171 178 187 195 202 211 220 223 224 232 240 247 251 257 266 268 270 272 281 277 283 292 297 304 308 300 301 309 317 323 327 327 334 333 325 333 327 336 338 347 349 357 366 374 380 382 386 395 404 411 416 417 422 427 434 443 440 449 451 456 465 473 470 472 475 484 492 498 504 513 521
 135 126 134 126 124 103 108 113 108 115 123 132 130 137 133 137 140 144 146 154 151 157 154 157 165 168 167 165 173 179 187 195 202 206 215 222 230 233 233 241 246 249 255 263 267 274 281 284 286 290 298 299 308 312 305 306 315 316 320 328 335 343 336 334 339 334 343 343 352 357 366 373 382 387 389 395 400 408 413 422 422 431 433 435 436 444 452 452 460 468 477 476 475 477 485 486 489 493 494 499
 138 133 141 132 132 110 117 122 115 124 126 133 139 143 136 145 149 153 153 155 153 161 162 166 168 169 172 169 170 179 188 196 205 206 213 222 231 237 238 245 246 250 255 263 268 277 282 291 295 295 297 301 303 305 309 308 310 318 319 327 333 334 340 337 341 337 345 352 358 358 367 376 382 388 397 398 403 409 417 425 430 435 441 442 444 451 458 454 456 457 465 472 473 474 483 492 490 499 498 506
 144 136 141 139 133 111 120 124 122 128 134 142 147 146 142 149 151 160 155 156 156 160 167 175 177 178 181 173 175 180 188 197 206 215 222 231 240 246 243 252 247 249 252 257 264 273 281 282 287 295 303 310 306 313 317 315 318 327 322 330 332 337 346 338 340 343 346 353 359 359 368 374 377 379 388 397 405 414 422 431 438 443 442 448 446 455 464 461 457 458 467 468 475 477 485 494 498 507 502 511
 147 140 149 148 142 118 119 128 123 124 133 136 145 146 143 152 152 161 156 165 163 169 176 182 183 187 183 176 183 182 191 198 201 209 218 225 229 231 233 242 247 252 261 264 271 273 280 285 292 301 309 318 314 320 319 320 321 327 331 334 341 345 353 342 342 351 352 361 368 361 368 377 381 384 392 399 408 416 425 429 431 438 445 450 450 457 466 470 463 466 475 477 484 485 494 498 505 512 508 517
 154 143 144 153 149 127 128 134 128 128 134 139 141 149 144 153 160 161 158 166 164 166 174 183 184 191 188 184 188 191 193 196 203 205 211 212 215 223 230 231 239 248 256 261 270 278 282 291 300 309 318 326 323 329 327 327 327 336 340 342 349 349 358 343 343 352 361 370 377 362 371 374 382 390 395 403 412 421 422 430 437 445 454 455 459 464 468 473 466 474 475 476 481 488 493 496 497 506 515 517
 155 147 150 158 155 135 132 141 134 129 138 142 146 147 150 158 163 169 167 175 170 175 183 192 186 190 197 192 194 195 202 197 199 205 213 217 220 224 229 238 242 249 251 256 264 268 277 285 292 301 308 313 321 330 328 331 335 338 343 343 352 354 357 352 349 356 364 365 374 367 376 379 388 397 400 404 413 422 430 434 442 448 454 461 464 467 469 478 467 476 476 477 485 494 501 505 505 514 522 518
 160 156 159 167 162 144 138 143 137 134 141 144 146 154 154 161 168 172 174 182 179 184 187 196 195 196 198 201 199 200 209 206 208 214 217 225 221 230 237 246 251 258 252 254 263 264 265 273 276 279 282 290 292 293 296 301 306 309 310 313 321 329 337 338 341 350 352 361 369 374 383 381 390 397 402 403 408 416 425 431 440 444 452 453 461 466 467 470 472 473 482 478 486 492 497 498 503 512 520 527
 168 165 165 174 171 151 139 147 144 141 143 150 155 155 159 163 169 176 183 188 187 191 192 201 204 205 202 203 207 203 212 215 217 223 224 232 230 238 238 247 256 258 256 255 264 273 267 268 277 286 289 291 297 294 297 306 314 318 319 317 322 328 336 339 344 345 347 355 362 367 374 383 388 395 404 412 416 425 430 438 439 442 450 451 460 469 473 471 480 475 478 486 492 498 506 500 503 512 518 527
 175 171 171 172 180 159 148 151 152 142 149 154 163 164 168 165 174 177 179 181 184 191 197 206 205 214 211 211 215 207 216 222 219 220 227 236 233 236 245 246 251 254 263 257 263 269 274 276 285 289 297 297 303 298 304 305 314 318 327 326 330 337 340 340 348 354 348 350 353 357 366 369 370 378 385 392 401 408 415 424 431 438 440 449 450 459 467 475 484 484 486 491 499 501 508 504 508 517 522 531
 182 176 179 173 181 164 156 157 161 151 156 161 170 172 172 170 179 185 188 190 193 200 205 214 209 218 213 219 221 213 220 229 225 229 232 241 239 243 251 255 252 260 267 265 271 278 278 277 281 289 296 302 309 299 304 310 319 324 333 329 337 343 341 349 352 361 353 353 361 363 369 371 375 382 383 392 400 409 410 417 420 427 430 439 446 455 457 462 470 478 487 488 492 499 507 511 513 518 519 523
 189 185 182 182 186 172 158 162 168 156 164 166 171 179 178 173 174 178 184 189 197 206 207 209 211 219 220 221 230 220 221 230 230 237 236 240 247 251 257 257 253 262 271 274 272 281 279 282 287 291 295 302 311 305 313 319 328 330 335 336 344 352 347 351 357 364 359 362 370 372 373 378 383 385 389 398 401 410 412 421 429 431 433 442 447 456 460 461 468 474 483 487 488 497 504 505 510 517 519 525
 196 191 188 186 195 173 167 167 175 164 169 175 180 187 187 174 176 184 193 194 195 202 209 216 214 220 222 227 233 224 230 235 237 246 245 241 249 253 260 266 260 268 273 279 276 280 280 288 293 300 300 304 313 306 315 320 321 328 335 336 341 349 350 355 364 373 368 371 376 373 381 387 387 394 396 405 409 411 420 429 438 439 434 443 449 457 464 468 470 472 481 484 485 488 495 502 511 512 513 522
 205 198 196 195 204 176 176 174 181 173 178 176 185 191 195 180 185 187 195 199 197 204 210 218 223 228 231 236 242 225 226 231 239 248 254 248 249 251 258 267 265 270 279 280 278 279 288 297 294 301 309 306 312 311 320 329 323 332 341 345 342 350 359 364 373 381 376 372 375 381 385 391 394 397 405 413 418 418 427 436 445 447 435 436 445 449 457 463 472 481 487 493 492 491 500 508 513 513 518 524
 206 207 204 202 203 177 179 178 183 175 178 180 181 189 197 188 188 190 191 195 196 201 208 216 224 233 239 239 248 228 235 239 241 244 253 255 253 252 257 265 273 279 288 287 279 288 291 297 303 302 307 314 321 316 319 324 332 341 344 346 350 353 359 363 372 380 383 380 384 386 387 392 400 402 403 410 415 422 431 440 449 455 436 445 448 457 459 466 475 484 493 502 496 493 502 504 510 517 520 529
 210 216 210 210 204 183 187 182 191 176 181 188 190 194 203 191 191 196 195 203 201 205 214 223 227 231 238 247 252 232 240 246 250 248 257 264 258 261 264 273 282 288 295 288 285 294 300 300 307 311 308 311 320 317 323 325 330 339 346 355 351 358 361 363 372 379 387 389 393 395 393 399 408 409 411 417 419 428 437 445 454 461 437 441 442 446 448 457 466 472 481 483 489 497 506 509 513 515 520 527
 212 220 214 216 211 189 194 190 192 179 186 192 191 197 200 200 200 204 204 212 207 211 217 226 235 239 244 249 253 237 246 254 259 253 261 262 261 265 265 270 274 283 290 295 289 294 303 303 305 310 309 316 325 323 330 332 339 345 354 363 355 356 365 367 375 383 392 390 399 398 401 407 416 412 417 418 425 432 433 441 444 451 445 442 450 454 457 458 467 471 477 480 481 487 495 497 501 502 510 511
 219 223 215 224 220 194 197 198 201 185 191 192 197 199 207 203 209 213 205 210 209 218 220 225 231 237 242 251 258 240 248 249 257 262 269 271 270 268 273 272 278 285 294 303 296 300 307 304 310 314 317 324 333 324 325 334 335 340 349 351 360 363 369 369 377 380 386 395 397 406 410 409 417 416 424 427 429 435 441 450 453 460 453 444 448 451 460 467 475 480 478 479 487 496 498 506 507 507 516 517
 224 232 220 222 226 200 201 206 203 186 195 197 204 206 209 212 215 222 207 211 218 219 228 227 236 237 239 246 254 243 247 252 261 266 274 276 279 276 278 280 281 284 285 291 292 293 302 306 315 321 325 331 334 329 332 335 344 344 351 360 368 372 378 375 380 383 390 399 406 407 411 416 425 424 427 433 430 438 446 454 454 463 462 453 450 459 467 476 482 488 484 481 489 498 507 512 516 510 519 526
 225 233 227 227 228 209 209 214 212 190 193 202 206 207 215 215 222 229 213 220 222 228 237 230 238 246 240 242 251 250 256 257 264 267 274 283 284 277 281 289 283 290 294 300 299 295 303 311 319 320 326 334 336 337 337 343 344 353 355 364 366 375 376 376 384 384 386 395 404 411 414 417 424 433 428 437 439 446 455 460 463 469 470 460 459 460 469 478 482 489 492 490 496 499 500 502 511 519 527 531
 230 239 228 236 230 217 215 222 214 193 201 206 215 213 222 221 230 237 220 229 228 229 238 235 239 245 241 245 247 249 257 260 265 273 282 284 291 285 290 294 291 299 296 304 307 298 307 310 316 321 322 326 335 344 345 350 346 355 361 370 374 383 381 380 384 389 395 402 411 412 421 426 430 431 435 441 443 449 451 456 462 468 477 464 467 468 476 481 486 492 501 494 503 505 509 507 508 516 524 532
 238 239 237 244 237 221 217 225 219 195 202 211 219 215 223 224 229 236 229 230 232 236 243 244 247 249 249 253 254 254 259 263 268 276 284 293 299 288 297 303 297 302 305 312 312 302 311 319 325 324 325 327 329 338 347 356 347 355 362 365 373 382 385 389 393 398 400 409 418 413 422 428 437 438 441 450 452 458 460 465 467 468 477 466 474 475 483 484 493 494 503 497 499 506 515 516 517 517 524 525
 247 242 242 248 243 229 218 224 224 196 197 198 200 201 207 216 224 226 227 236 241 241 248 249 251 257 258 261 263 258 261 264 272 277 284 285 294 297 305 311 306 310 313 313 317 311 319 320 325 331 326 335 330 334 343 351 355 358 367 370 378 380 381 387 394 401 407 409 410 418 427 434 439 445 448 449 458 464 461 464 473 477 486 475 476 476 483 492 498 496 503 505 502 510 519 525 520 524 528 534
 256 247 249 249 249 236 226 230 233 198 206 205 209 208 215 220 221 226 235 244 242 245 254 258 257 259 267 270 266 267 267 272 273 282 283 292 300 302 303 311 313 313 321 321 319 320 328 328 327 335 334 337 332 338 345 346 354 363 369 376 383 388 390 388 394 402 409 418 416 425 432 441 440 446 451 454 456 465 467 473 482 486 493 479 480 484 484 492 501 503 512 512 510 511 517 526 529 528 533 534
 260 251 258 258 258 243 233 238 235 200 209 214 218 215 224 228 229 229 230 237 241 250 256 261 265 266 275 278 275 276 273 281 274 275 278 287 295 297 305 314 314 320 326 327 323 323 325 334 329 331 336 344 334 335 344 353 358 361 366 375 382 383 387 390 397 402 410 414 420 421 422 431 440 447 452 454 457 465 467 472 480 481 485 488 486 493 493 501 508 506 514 513 513 513 519 525 531 537 540 536
 269 254 261 259 262 252 241 242 243 209 217 221 221 217 222 224 227 232 232 241 242 245 254 256 264 273 274 275 283 285 279 288 283 283 283 292 300 302 304 309 310 317 321 329 331 332 333 341 337 340 342 343 340 344 352 353 355 364 369 370 372 381 390 399 406 407 413 422 426 428 430 433 439 446 455 456 465 473 469 478 487 490 487 496 495 502 502 509 512 509 518 517 521 522 520 526 532 537 538 545
 273 257 263 262 264 257 242 247 251 210 211 212 213 221 229 232 236 241 237 239 243 252 256 259 268 271 278 279 284 293 285 294 289 291 291 300 306 308 312 317 313 319 328 336 338 340 340 344 344 346 347 349 344 353 360 358 364 370 376 379 376 385 393 402 406 412 416 419 420 429 437 435 444 453 462 457 466 468 470 474 481 490 494 502 503 503 509 512 519 515 520 523 528 530 527 532 538 544 546 553
 275 258 262 271 269 260 243 244 253 217 218 214 218 225 234 235 243 246 243 240 249 258 262 265 273 276 284 288 289 291 294 296 296 300 295 304 312 315 315 324 317 318 324 333 341 341 342 347 353 349 356 350 347 348 357 364 368 370 371 380 379 380 381 383 390 399 408 417 424 431 440 444 452 457 465 466 475 469 475 482 490 496 501 504 509 512 518 521 521 516 517 521 528 536 530 538 542 550 547 555
 281 264 267 269 276 264 244 252 253 219 227 216 225 233 236 243 251 248 252 249 258 267 263 264 269 272 276 284 293 300 298 305 298 301 304 312 314 323 320 329 318 324 332 340 343 347 351 355 362 353 362 351 356 357 363 368 377 372 379 388 388 387 388 389 396 403 404 412 416 422 431 439 447 451 459 461 469 470 479 485 494 500 504 511 517 514 523 530 530 525 524 526 535 542 533 539 547 550 555 562
 285 266 271 274 279 272 247 253 257 227 235 217 226 232 239 241 244 245 253 250 257 262 263 267 276 278 277 286 295 304 306 314 306 309 310 318 315 323 329 334 326 325 332 341 347 355 356 364 370 355 359 352 361 364 372 371 380 375 379 386 394 391 394 398 405 409 413 421 419 427 428 433 442 444 445 452 460 469 474 479 488 489 490 494 500 509 517 518 524 531 527 535 544 551 537 544 547 555 561 568
 289 275 277 278 283 277 252 260 266 235 239 218 219 224 233 236 243 252 261 254 257 262 265 267 268 275 278 287 290 296 298 306 312 318 316 325 319 327 329 338 333 332 340 345 353 362 364 373 378 360 364 355 361 365 366 367 376 383 380 381 386 395 401 406 406 415 415 420 425 434 435 442 450 453 454 459 468 477 475 476 485 490 491 500 508 510 511 520 529 538 531 539 547 556 546 548 549 550 558 562
 298 282 286 285 286 283 258 262 264 238 247 227 228 225 234 243 244 251 253 256 265 271 273 274 274 280 287 293 299 305 301 304 307 316 324 332 328 334 338 345 342 339 342 343 352 355 363 364 370 363 364 363 370 366 370 376 384 389 383 384 392 396 405 409 410 414 423 421 430 433 441 450 454 461 462 468 470 476 483 482 488 489 497 506 514 519 512 514 523 531 532 541 542 550 551 549 558 557 563 566
 304 288 294 292 295 292 266 263 266 246 248 236 230 229 236 243 252 252 257 257 266 273 282 282 277 281 288 297 299 306 308 310 311 317 325 334 336 343 343 345 351 347 348 351 360 364 370 373 374 368 371 364 370 370 377 382 390 393 392 391 400 405 414 413 416 423 432 430 439 442 449 458 463 470 471 474 473 482 485 483 489 494 503 506 514 523 515 521 530 531 536 543 544 553 558 557 565 563 569 567
 309 293 302 294 302 296 273 271 271 252 256 242 239 236 241 244 248 257 259 261 270 272 281 289 285 290 296 297 306 311 316 318 313 322 327 336 339 347 346 353 352 352 355 360 362 367 373 382 382 375 380 366 371 379 384 391 397 398 400 398 407 411 415 420 424 425 433 437 443 451 458 459 468 476 478 481 475 476 485 492 490 498 507 508 516 525 523 530 531 539 538 539 546 551 555 562 568 571 578 574
 317 301 304 300 301 302 282 272 280 260 258 243 247 238 242 251 256 265 265 270 271 278 286 295 286 295 296 297 302 310 314 323 321 322 325 330 335 344 349 356 361 359 364 369 363 371 378 387 391 380 386 367 372 381 388 396 400 399 408 404 408 411 413 417 426 434 440 442 443 450 455 463 464 472 478 486 483 483 488 497 497 498 500 502 510 514 518 523 525 526 530 538 547 553 562 567 573 576 585 578
 326 310 313 301 310 309 291 281 285 267 264 249 252 239 243 252 260 268 273 279 275 280 288 297 290 292 300 299 300 309 317 326 330 331 331 333 336 338 340 348 354 363 370 371 367 376 385 394 393 382 391 376 375 384 388 397 398 407 414 412 413 420 418 425 434 443 446 450 448 457 457 465 470 472 481 490 491 492 496 504 506 507 508 504 510 514 523 524 533 533 536 537 538 539 542 549 557 566 573 576
 334 318 317 309 310 313 293 285 294 271 273 250 251 247 249 252 258 261 270 277 277 284 290 299 294 301 301 308 309 318 326 333 339 340 337 341 337 345 348 351 360 366 373 378 369 377 383 392 401 389 398 378 377 383 392 401 405 406 415 421 420 422 426 429 430 438 443 447 455 462 458 467 474 479 488 495 498 500 501 510 507 512 513 509 518 515 524 528 534 537 543 546 547 546 550 555 564 566 573 578
 341 325 324 318 317 318 302 286 294 280 276 257 260 253 255 256 265 270 279 278 280 289 296 304 296 297 306 312 318 324 333 342 348 349 341 347 340 346 348 356 363 372 380 386 372 380 382 387 395 392 400 384 383 384 390 399 400 409 418 426 425 429 431 430 436 443 444 449 456 465 466 470 472 479 486 495 503 507 508 515 516 516 522 516 522 516 517 523 528 534 543 548 554 554 558 557 562 567 576 577
 347 332 329 327 321 327 304 293 299 287 277 258 260 260 260 265 268 276 282 287 284 288 297 306 302 306 312 313 322 328 329 330 339 348 348 356 346 351 357 365 364 368 377 383 373 381 389 388 397 395 401 391 392 393 399 403 405 414 423 430 428 430 439 439 444 451 453 451 453 462 469 473 480 485 493 501 502 510 514 515 524 520 528 520 526 520 520 529 531 539 548 553 562 558 567 565 571 570 579 585
 356 336 336 335 326 328 306 297 306 292 278 267 261 266 269 268 276 278 282 290 292 297 301 309 304 313 321 321 326 335 332 338 344 345 354 355 353 360 364 369 368 377 386 389 380 389 395 393 395 404 407 400 393 402 403 412 407 415 424 431 435 431 438 445 446 455 461 457 462 470 474 481 488 490 494 502 510 519 516 524 533 525 532 527 532 529 528 536 538 543 548 553 556 562 571 569 578 576 579 587
 358 344 343 344 330 336 314 301 303 301 285 272 269 275 273 273 281 284 283 287 295 296 305 309 305 309 314 323 332 337 341 342 350 354 356 364 354 359 367 368 373 375 384 387 382 389 390 399 404 413 414 406 400 403 407 416 413 417 425 427 433 434 438 441 442 450 456 465 467 468 477 486 493 491 493 497 499 501 510 511 520 529 533 530 539 534 537 545 545 551 557 557 565 571 574 577 578 585 583 590
 367 345 348 345 339 345 323 305 309 308 286 281 274 275 280 279 282 290 285 292 301 298 305 313 312 318 318 320 325 327 336 339 348 351 352 356 362 368 374 377 381 384 392 390 390 394 393 394 403 407 415 414 409 410 408 415 421 425 431 436 439 442 445 447 451 459 461 464 472 470 474 477 479 488 496 497 503 502 508 509 516 517 526 530 537 539 541 542 551 560 561 562 571 580 581 585 582 590 584 589
 376 349 350 347 347 354 332 308 316 315 290 290 281 284 288 280 288 297 294 301 305 306 314 322 318 326 321 329 327 336 342 348 357 358 361 361 366 375 380 383 386 393 401 394 396 403 395 402 406 412 413 421 416 419 416 423 424 430 436 437 444 447 447 455 459 468 469 472 478 479 480 486 482 483 490 498 506 503 511 517 520 526 535 539 539 547 547 544 547 556 559 560 566 575 581 590 583 587 593 598
 379 354 351 355 350 355 341 317 325 321 293 297 283 291 290 285 293 301 297 305 306 315 315 317 322 329 329 334 335 342 350 357 361 363 363 362 367 371 372 377 386 394 399 400 404 407 399 406 415 419 416 417 417 423 425 430 432 436 445 441 446 454 451 459 468 475 478 481 487 487 489 491 491 491 497 506 508 511 518 526 526 533 542 543 548 556 556 545 548 554 558 560 562 571 579 588 588 588 595 601
 387 363 358 361 355 359 343 323 332 328 295 303 291 298 299 291 300 309 306 307 311 318 324 326 331 330 331 334 336 338 339 348 355 363 372 369 376 380 381 385 394 403 402 409 413 408 406 408 412 417 425 426 420 429 433 435 438 445 454 442 450 455 460 461 470 477 480 487 489 496 490 497 494 499 506 514 516 520 524 529 528 532 539 540 544 548 557 550 551 558 564 569 568 577 585 589 597 597 603 609
 395 367 366 362 358 367 348 328 333 337 301 306 296 305 307 299 308 316 311 310 314 322 330 333 340 339 332 341 344 344 348 356 364 371 380 371 376 377 382 390 393 399 400 407 408 416 408 417 419 423 424 429 424 428 434 443 447 450 457 444 445 452 458 466 471 480 482 484 493 499 499 506 502 508 515 517 519 522 523 525 530 539 546 544 553 553 562 559 556 562 566 575 571 580 589 598 605 601 603 608
 402 376 368 369 359 362 351 337 334 337 309 313 305 312 312 302 310 318 320 319 323 331 339 342 349 347 336 345 353 347 353 362 365 366 374 372 380 386 386 392 396 405 406 415 417 420 416 424 423 429 425 433 433 429 432 439 445 454 462 453 454 459 466 474 480 489 490 486 493 501 506 507 509 514 521 519 528 524 527 532 539 548 553 547 555 562 571 560 565 567 571 580 574 578 584 591 600 607 608 612
 409 382 377 378 364 369 358 338 343 339 318 319 312 321 320 303 311 320 326 323 330 339 340 341 349 352 345 350 359 352 354 357 366 374 380 380 384 386 395 393 402 404 413 421 426 429 425 433 424 432 433 435 441 435 440 447 449 454 462 462 458 460 461 468 470 471 472 473 475 484 485 488 496 501 502 505 508 516 521 529 536 537 543 552 556 564 573 567 569 568 569 570 575 577 582 589 591 600 608 614
 418 383 385 386 373 378 366 342 351 343 327 327 321 330 326 311 319 324 328 331 339 347 343 348 349 357 350 359 362 359 355 360 368 375 379 380 389 394 402 398 405 410 418 427 435 431 426 434 433 441 440 444 449 441 445 452 457 456 460 467 466 463 464 473 478 472 475 481 484 491 489 497 504 510 511 514 511 513 522 529 534 540 545 549 558 559 566 575 574 577 578 579 578 585 590 590 598 605 611 617
 427 388 387 387 380 383 369 347 356 352 335 329 330 335 328 320 326 325 334 339 348 351 348 354 355 358 351 359 361 366 363 361 368 375 383 387 396 399 402 404 405 414 418 426 428 431 427 430 436 445 447 446 449 447 454 461 460 458 467 475 473 470 473 474 481 475 479 485 493 497 497 506 513 516 513 522 512 518 526 535 542 549 554 551 557 564 566 570 578 582 587 587 582 590 595 597 605 612 618 618
 432 393 392 388 388 391 378 352 356 361 339 333 338 338 336 329 331 334 335 343 349 358 355 358 364 367 353 357 363 370 372 369 373 376 383 384 393 397 402 403 412 416 425 426 435 440 432 439 444 446 451 455 458 456 459 463 464 461 469 473 480 474 474 479 482 478 485 492 500 505 499 508 512 517 514 523 515 518 525 530 539 548 556 552 561 569 571 578 581 586 593 588 585 590 591 596 604 613 619 627
 439 401 400 394 391 400 381 353 362 370 340 335 344 347 344 338 338 335 344 350 351 359 358 359 365 373 361 366 371 375 381 378 374 383 388 393 399 401 408 410 417 418 427 431 439 445 441 447 446 455 459 464 467 459 462 468 472 465 468 476 485 475 482 487 486 484 493 501 508 511 508 509 515 522 523 526 516 523 531 531 536 540 546 553 562 565 570 574 581 583 587 596 594 597 600 603 611 617 620 623
 448 406 407 398 400 406 386 356 365 366 341 344 353 348 353 340 347 343 344 351 358 364 362 366 366 374 367 372 372 375 383 387 381 390 397 395 400 407 415 413 414 423 432 439 447 452 449 454 447 456 465 473 473 462 471 473 479 474 469 474 475 482 490 494 495 489 498 505 513 518 517 517 521 530 531 534 525 525 530 538 539 547 555 561 563 571 576 579 583 591 596 601 595 601 609 605 606 607 616 622
 451 415 409 405 407 415 393 363 372 371 345 352 360 354 361 348 353 352 347 353 362 370 370 370 371 378 374 378 374 382 391 391 389 390 399 404 407 412 413 421 415 424 425 433 440 445 454 456 456 460 461 469 476 467 468 469 474 475 478 483 480 489 493 495 501 498 507 514 522 526 524 521 530 539 537 543 532 532 536 537 545 549 551 560 569 577 583 582 591 599 601 603 603 603 610 614 608 614 623 630
 460 422 418 406 411 416 402 368 376 380 353 358 365 357 366 355 361 361 353 361 369 376 374 371 373 380 378 387 380 385 393 400 395 398 402 406 415 419 422 425 421 426 426 430 438 447 456 463 465 461 466 474 483 473 471 475 482 476 480 487 489 495 501 502 502 502 510 518 527 534 525 530 539 547 544 545 541 535 544 546 547 553 558 566 574 581 585 590 598 602 602 607 611 607 615 622 617 623 627 631
 465 424 427 414 415 424 408 377 380 389 361 365 373 359 363 358 364 365 360 369 378 379 383 373 382 387 387 388 387 390 397 405 397 398 407 415 418 422 425 428 424 425 434 432 441 442 445 454 462 464 473 481 490 481 475 484 487 485 483 489 494 499 507 511 507 511 517 520 526 535 533 539 542 551 553 553 545 543 552 551 556 560 561 564 569 571 572 576 582 589 595 603 611 615 620 626 625 624 629 630
 469 433 436 416 424 432 414 383 389 393 369 372 381 364 369 366 366 368 369 378 386 386 389 381 382 386 391 392 390 399 403 410 405 405 414 422 422 426 426 435 429 434 436 433 440 447 451 457 466 468 476 484 489 488 482 485 494 493 491 491 492 501 510 519 509 512 518 527 531 540 542 543 545 549 556 559 546 551 556 560 559 567 563 572 572 573 581 584 591 591 600 609 618 624 626 635 626 627 636 639
 476 440 437 422 430 431 415 391 397 400 378 378 383 367 374 374 375 377 370 379 388 391 395 385 389 394 399 401 394 399 407 414 406 413 422 423 429 433 435 438 437 443 438 442 449 453 455 462 463 470 474 482 490 492 488 494 499 495 497 495 501 510 519 528 518 513 518 524 531 534 543 549 553 556 564 561 548 553 555 564 563 564 569 576 575 580 583 592 597 600 601 607 610 614 618 627 627 628 635 642
 479 446 440 425 432 437 421 395 404 409 387 387 387 375 376 382 383 386 372 380 389 391 394 394 397 403 401 408 401 400 409 418 414 418 425 427 431 436 444 445 445 450 443 449 455 462 456 463 467 476 477 486 494 501 490 495 498 500 502 503 510 519 521 530 526 516 523 531 538 536 545 553 562 557 558 564 551 552 555 561 563 570 576 582 583 582 591 592 597 606 610 615 612 621 622 629 636 635 644 651
 488 454 442 432 438 446 429 403 412 412 391 396 388 382 380 389 392 394 373 382 388 396 400 398 405 412 407 416 403 408 411 418 416 425 434 436 438 440 449 454 453 459 450 458 460 467 460 461 464 472 474 483 485 489 490 497 501 508 505 512 519 523 522 530 533 525 526 529 530 539 540 548 551 560 561 562 553 560 556 561 565 569 571 576 585 583 590 599 606 608 614 619 613 622 627 630 639 642 650 654
 493 458 450 437 443 444 432 409 411 417 398 405 393 391 383 390 396 402 379 386 391 393 402 400 404 412 415 420 409 412 418 419 424 425 433 434 440 446 455 463 462 462 456 462 469 472 464 470 470 479 483 489 491 490 499 506 502 511 513 521 526 531 530 537 542 534 531 534 539 542 549 554 555 562 565 570 562 567 563 567 574 574 579 578 584 587 595 604 605 612 617 621 618 625 634 632 640 647 648 649
 501 465 455 445 448 453 434 416 420 426 403 405 402 400 389 398 402 405 382 384 391 398 407 403 411 420 424 426 413 420 427 428 431 434 439 442 446 455 458 462 469 470 464 470 470 477 471 475 476 485 492 496 499 496 505 514 505 511 520 525 533 532 534 543 548 538 540 539 548 551 553 562 556 564 572 571 568 571 564 573 582 582 583 586 585 594 597 606 614 617 622 630 627 631 640 635 644 649 657 658
 508 474 462 453 452 459 443 417 421 429 412 408 409 402 397 405 408 410 391 387 396 405 406 411 413 417 425 426 414 421 425 431 439 440 448 445 454 458 460 462 470 476 466 474 473 480 477 484 480 489 490 496 504 505 514 520 514 518 520 529 538 540 542 547 550 545 545 548 552 556 561 567 561 562 566 568 571 579 573 575 576 580 586 594 594 599 606 612 614 616 625 631 632 633 634 642 647 656 665 663
 509 483 471 457 458 464 446 426 422 428 417 416 417 411 406 414 412 411 398 396 404 408 414 420 418 425 426 429 423 427 433 436 443 447 450 450 457 464 461 469 476 484 475 476 482 481 478 480 489 498 499 498 507 514 517 526 522 524 529 531 532 541 549 550 559 552 547 550 557 560 561 567 568 569 567 575 580 587 577 582 583 587 595 595 595 598 605 614 620 617 622 629 630 638 643 647 649 657 662 668
 517 484 477 464 459 463 454 427 430 431 424 424 422 418 415 422 417 418 405 405 412 409 418 425 423 424 433 438 431 431 440 444 452 455 458 457 466 473 466 468 477 482 484 477 481 486 485 488 496 502 505 506 514 520 525 533 531 529 531 533 540 542 548 557 561 556 549 557 563 566 563 570 569 570 571 575 583 592 585 590 587 596 596 604 597 604 609 618 620 618 626 633 638 647 646 655 655 662 671 675
 518 493 481 473 466 471 455 428 435 433 427 426 431 426 423 430 423 420 410 414 418 418 419 422 428 430 434 439 440 437 444 445 454 463 463 463 464 466 474 477 484 483 485 480 488 491 490 496 498 501 508 514 519 526 534 538 540 538 532 533 542 551 549 557 566 558 558 564 571 573 572 573 577 575 578 577 578 581 590 598 595 604 603 605 602 606 611 614 622 627 627 633 642 643 652 658 658 659 661 670
 527 502 485 480 467 474 463 435 438 442 429 430 439 427 424 425 427 429 413 414 422 420 428 424 427 435 443 442 445 438 439 444 451 456 461 469 466 473 482 486 493 492 493 485 494 494 499 502 502 510 516 517 518 521 524 533 539 547 536 538 547 553 558 563 569 567 561 570 579 574 579 582 585 583 586 582 587 590 593 595 602 603 609 607 611 610 616 623 626 635 636 634 638 644 652 659 664 668 668 674
 536 509 492 482 476 481 465 443 440 449 434 435 444 435 433 430 435 438 422 422 427 424 428 433 434 442 450 447 454 442 447 449 454 463 470 478 472 473 479 483 492 501 499 492 499 502 507 505 510 519 519 525 520 528 533 536 542 543 545 547 551 560 559 562 571 574 567 571 579 575 581 582 591 584 591 590 592 592 601 604 607 611 611 608 609 618 622 631 633 635 641 641 640 649 654 657 665 666 669 674
 544 518 494 489 480 482 473 448 443 451 443 436 444 441 441 432 436 445 428 431 428 428 434 441 438 447 455 449 456 447 453 456 463 465 473 480 475 477 485 492 497 498 499 501 500 502 505 507 508 517 523 531 523 532 540 544 543 545 554 555 560 567 563 570 576 583 572 580 588 576 581 588 597 593 600 592 594 598 607 605 614 620 615 614 616 624 630 637 641 644 643 650 648 650 652 657 666 673 676 683
 546 525 495 496 482 483 481 453 444 451 452 437 444 447 448 437 444 453 434 435 434 435 435 436 445 450 459 451 458 453 456 464 470 472 475 476 480 483 487 488 492 501 505 505 506 509 509 514 516 518 523 532 525 526 534 543 551 547 552 560 568 576 570 579 581 590 579 588 597 585 589 595 603 602 605 598 603 603 611 612 620 622 624 616 624 632 633 642 647 653 644 647 656 657 658 661 664 668 675 681
 554 533 502 504 491 492 489 462 453 456 455 444 453 450 455 441 450 452 442 437 439 437 441 437 443 452 461 456 457 460 463 470 474 479 484 485 484 486 493 496 495 501 510 508 508 515 513 519 521 523 526 529 533 534 535 537 545 549 557 563 570 573 578 582 588 597 581 587 593 592 596 596 605 606 613 606 612 612 620 620 621 623 624 619 628 632 640 647 656 660 645 650 656 661 667 666 671 676 684 685
 563 540 508 512 498 500 495 470 462 465 461 452 456 458 462 445 453 455 451 439 441 445 445 446 451 458 460 460 461 466 464 473 480 480 487 494 493 490 496 505 503 510 519 515 517 523 519 526 522 526 535 538 535 542 544 545 546 555 556 565 569 578 587 588 597 606 587 592 599 599 604 601 609 614 622 615 620 620 626 629 625 625 633 625 633 637 643 648 649 657 652 659 665 669 676 667 676 682 691 693
 571 549 510 515 503 501 504 474 470 473 469 454 462 465 470 454 455 464 460 444 443 451 454 454 459 463 467 469 469 474 469 478 483 487 492 497 501 498 498 507 511 517 526 523 522 523 520 521 530 531 540 547 543 544 553 552 550 556 557 565 567 568 576 577 578 579 586 590 599 606 610 607 610 619 624 623 623 629 627 635 627 631 633 630 639 638 646 651 651 658 659 668 672 670 676 671 674 678 687 690
 578 558 516 520 510 502 508 483 479 475 478 462 466 472 476 460 459 463 466 450 448 454 458 457 466 468 476 475 472 479 477 486 492 494 501 504 510 501 504 507 516 524 525 529 531 532 523 530 538 540 549 556 552 545 554 561 558 561 565 566 567 575 578 586 584 585 587 594 602 604 613 610 617 626 627 630 632 633 633 635 635 632 633 637 644 646 651 658 660 667 666 668 670 677 678 677 683 686 690 697
 579 563 521 529 513 509 517 485 484 480 480 471 475 481 483 462 465 469 474 459 451 454 457 465 471 469 476 476 477 486 479 480 488 496 498 499 507 509 513 515 519 522 524 530 538 541 530 538 545 547 550 559 558 548 556 563 566 567 566 575 576 581 583 590 588 586 591 595 604 613 622 616 622 624 632 634 640 634 635 644 640 641 642 646 653 648 656 665 661 670 669 669 675 684 679 679 683 692 699 702
 586 571 530 538 521 518 526 489 488 483 488 480 482 487 486 471 474 470 475 465 458 457 463 465 471 476 482 484 483 487 487 482 484 490 498 506 508 512 521 524 528 530 531 535 540 546 539 546 549 556 559 566 567 556 557 562 565 573 574 582 583 589 591 595 597 593 600 604 613 617 623 620 629 626 635 641 641 635 636 637 641 650 646 655 654 657 665 666 669 670 677 673 678 684 680 688 691 699 705 710
 591 580 537 546 530 524 525 497 497 484 486 489 483 488 488 474 476 479 484 466 464 462 471 470 477 481 482 490 484 490 495 486 486 491 494 495 496 501 504 511 514 523 532 537 539 543 542 548 549 557 566 573 575 565 563 563 571 572 578 586 590 590 599 597 606 598 602 604 607 608 616 624 633 635 640 644 648 642 637 644 650 657 650 655 663 666 668 671 676 679 685 679 679 688 685 694 700 703 705 708
 593 581 539 540 534 525 531 504 501 493 493 491 488 491 497 481 479 488 490 469 473 471 478 479 479 484 484 489 486 495 500 492 487 493 502 501 505 502 503 511 515 524 533 540 547 550 551 557 556 557 561 570 573 568 569 565 574 578 580 583 592 599 600 605 614 607 608 611 609 611 620 628 633 642 647 652 657 643 646 648 650 655 651 660 668 667 671 675 677 686 692 686 682 688 693 694 703 704 713 715
 600 589 545 548 541 534 537 513 510 495 499 500 494 499 499 489 487 492 495 477 479 473 482 484 481 483 490 498 495 503 501 493 491 498 504 508 514 511 511 517 523 525 534 542 549 556 552 555 563 565 569 576 574 577 570 572 580 587 583 591 596 599 608 613 622 615 617 619 613 620 621 630 636 641 647 654 656 652 653 653 657 661 658 660 663 668 672 679 683 692 698 694 690 689 694 696 705 706 708 715
 608 597 553 551 548 536 542 520 514 499 508 503 500 504 508 497 493 500 504 484 483 480 486 492 490 492 493 502 504 506 503 501 492 500 508 510 518 520 520 525 530 526 535 544 553 557 561 564 572 570 577 577 575 577 572 578 583 589 591 599 605 604 611 619 621 619 626 624 614 621 625 632 639 641 650 657 663 660 656 657 663 668 664 668 671 675 673 682 691 696 705 698 698 698 697 705 714 709 717 719



6851182918317729984894479998919639588287499951229786985839869531985173849166964176451789434892199898
9426994946481789516799194682986158574783332188959768397416981269349655657969713682881596193639995681
3796886996869882629998132915973989548786867985998963691489853939899277919988858417991899981198719977
9248185139261798695718986776781989149442673212774599795188279468121787972899969696979856585911949398
6299473779566125911813915682136997199718287928169899397951248974185914193847568951998753279193952849
8148286974115181837394769599139891971978995999535739268969879319467496912998861171928998691659198989
7714687982854699756819437711488839929337718978941199979812279537259321914799597345927229986211994549
1859191762117353799861888195973613898594811595799719427974391939471929349466985865972994437884976918
4789924996582993992899958998398993587621899599782949299194867972848998592987992641836281142799987191
9685322981798759174989138791499887198763891994992689973776397683579958996897917454769885649448846998
6789191274213349898637897949987691642999121985912278669499497294631978879989687988772597899489398853
8899541187936687986764981174139122881959961816983885493199685939951265698122877778946175159918528939
9952699986439995635899891246126799752986783919995866921811257898893149769954463369478989997852998513
9931425891581899192381949272615788327478998239344791911714828896265671432569198189774762995997816999
8581618784927336497999229995697796195918393877818976787576616927699141958127928917996839499769899276
8369858669942937955912211816442699772683941894396427761767385991988919159299218913385817898299451225
6599864914998939412789949497399559686786199654269695968467612419638975799587182839689615354288517687
4324765578179939112987917815945377869195454495959997291949517521699691991554697624199589939789426676
8998943917666297991734661946185856692979675845962856849349289995835969527961564598586189299197239649
2474349998759125929824899596169699498194929969789495971989693353319989798589959994997191896775279666
9397823311992847298999315312637987993188796995292697771188653763819292898624997515579394598123986699
2999757939894996746879469973889874978918536847939782945591488939679598979779585959621881889632813415
3786879979379639997228893154199891799657145859599524224228186163438961996693568885878772218711991948
6357119476898367292134799994558999999959123579815889388789382591263761963299898988162997119173898949
3499971911939119191979976923829738974229559772757989872536949884296992794587989427754799689998947769
7319799654652819812812891758592372613871898598499998998769988491199991938858991878959745381157531992
1468684961945168589969992498649126855459472584987975891483519539678195959954998486675329191189898981
5999796535732847747899499629559999481989991291183338213553138881392987929751589694818513519186515989
8969971877279154679687599942839999789819924199219972613989945683512875795799895813819961923866923969
7661989481759992932237691998849721793391539266789486647194998941891234931877977977291988998583745959
7581858699779845989999894928667969596789187889414876715696938619495386625719891737397925889147875514
7939582575855863146589222872971958448862199919156447969996578964676999478369392994395941769419715726
7664919588599891289517773626649579918479785644186954919517715835999961894979829998196877229313779119
9789939779919686938527689899911589971279559121991792659929991899988138467398979998119486996973985156
1987113452341888331415788983939823974158899719369158953599328364987895258517579998193927999942926739
4968168491589593364854994479548794995979997169937913916259791732978999679787499897141429969268954257
2846767823761639989966699865459895813415497745932517967796994194889193889361771837818891946316824181
7419953896616283991529356659738189899382679976716488911915929762836929928489468999824399891189396596
5952664821957739692491929127834595859858331611949787357394798996537991479836188819992989786289969399
1875298894394183776949938912979573795149279972888168285819492911812997337919989696879199478973129985
5919286823859696987961954614228358927895892883936514998729698954459791996176462566948885569496951888
8198742852798283579147798488755458898399659854999332299918738949995991969769999951928783929327999171
9356681651112169821995754898943385719988988159815719149883958216777218975771961399992179627838993749
9571678692979785159914996299396819198518738829982883267189677891687969791655296999744818979781699451
4499977822999798831749658798996911398289176643292258219953597143758461199752382581496999738132666972
9371498489873252352913928911896998598525174889888961698129512999956967836792982999299998439489166519
4363251581111888995249439374596968896688369878747656498596794989464319829991922479788173765678766788
2149531197725793856199668589529279498739416981259391319742193112799977998589916896736999211478384818
6652741812929838829999115348994923982959168836989491996592899776771846988482819696478299997597368387
4255583648819672318175149619998988681895817968598241979393478469969938159217895591146981673999473867
4964555898411593799435321739362869694829778589898553641198115978192569798997991195198219994889942184
9797366423999199172399876696993339889797973193816318914986338494449193894889268661898912981918519764
6687998138292477915197983479277646898952986899794571647684979994699999899996393165938937915729788661
5592847856869753492492988981958829593838157925698792597975879647828769919877219918928989182175476897
8836169198218249896917891911584981355957979918799561597841964324997517581868875971228445214896956594
9991979957665149888945894282198999633228697249992299394919785958996859286299898899826491976111378973
8848142494911863639727694919999799681883967728699792269971997284185487197797785915559194647997869275
7779759189379664999139782196969999463628798838258386616919985751671579842779877794976116569578825591
6759492767112759386944996961961199796599149618819367999459973299889229748688186194846439389594989398
9478522495191693824889482998593861917975499679652969194928977177298698588548892995776988755536949638
2879488429758945861481941459959489291581529327199976734964826343186951997124229199439599789499381947
9151999467195176382792787942529393148979898385319488971788696876995382432981616171947541994599784815
9422899387497981899948996839296997955966599469284618798836617528898869693178818849992862393169691499
3518359996372825883819125785878945215415985684479731169786945848979998959879287967949991364229895176
8976542697288796999257999123221978979998993991724599398569918592973729173898896524714495376969849988
8481395559655988985348879919869898925158361718297615446995721768592296998993331259749599564939998425
7927133913879753889999999849936931818946496994884618913769899788998278717672924799738991955934679754
7699577192967981896479118595952398684291929899991882868845894217211129138513385871694897411152572986
9188998494989968854898371859371587419885768992189979865782478339813897498999329756549179599938818766
9521753599829529719894566318278177879536194823136972369932987791734696899629168989926724859848578771
5551889549448389591869749924679853719451949199598259995443847415337788294519337599819858357135158969
7886393199129989719728316889859919596477729586982989933684389188469986916793178154679354724997978633
9574965391199192981776471866138979925783199887871999639579151787959787986988925838982865489516921196
3927797795488688693698845776289481997518191875929418751151995942699998749969776184299873985282792798
9791559589867397896887412749658968449794651489979158963681479687148898199872939926788748841584889944
5298496949878243647993929791757821993433319291398398984959365589597369893998489597335214676888568151
4992986694879568239987681454396787984419592177669488577398821999236959943476185938293298929999691399
7716811887965378991995647889458718917793892996471748846952649999915673968782252941673739691634491177
3633766499994828892892398927719985744597875769174939892535589929837872989116313627768291599829479799
9827698893491749981968648969283729997499897957413829241748399418793319183931281544259179926519539784
5485613626795937686752924885647181816699936695496996619919897887995593964748977695826489175457928711
8758592799529969633277938996489979686934788817756997869936958149649599491881641998481939955996939599
7978479148937288659399182481174686939422862837694916899697299885375945865142389214689596229652185995
1994663916588999417984895813968577357718789291129992993986921983972374167718984777911379615718952856
8167148183785798577981975199849898879952959145788668868895228269442866271144898849192759218789396797
1949781172329888625969136645967199561289712385582378579599119918929787938572139889725453891691963129
9947178739249111493182923893511575582799998593964983133969459696693991798885993271629469499146876976
9772972829559895899854497885948559996164996778838938289361994913976481619178529958211969726729538135
8927428538918682496914684982756792873489511912321968398812989748695991579992269199467887892982259779
2717218517917675896467119592763877315641496467478259218982588979597999878956958782928839691397643476
8878998995379374928252616995177747994378369327465533881284867384792667719488999812139487971565957894
9768786899684874839228498724461971799469899798671499289819194996996577858899886942968565187998919698
8925519488828789299528988579885957558829879851119599829746182181117497663958391826259185277971643493
7965716992984766446656439596378997979363981699398999919985811839662782937937946281177857997227269847
1559379255299972668933386171592188218898432689787739638786199657415499966284812959999289193169124995
7899899443897639915673626768648226882499987556984997981538887885979994649297111149491991818456198868
5979961891291523299165957518168425311537399524361897896181687192954231889954771797459935798619599423
2121416749725397396399792525295616969118499787997149336296239918996723985978919425198144297736819197
7868796992696828855862952279981147679986829877138887191789385398989849196567297576723547696881529227
8883726744936598689747689939932818828998719994999581122656889578249517477297783467688719959489399394

</samp></pre>
<p>I am stuck at the moment with <em>a correct test result and an incorrect
puzzle result</em>. Not really sure how to debug.</p>

</main>
<footer>
<hr>
<div class="nb-box">
  <span><span class="nb-small">made with <a href="https://pietroppeter.github.io/nimib/">nimib üê≥</a></span></span>
  <span></span>
  <span><button class="nb-small" id="show" onclick="toggleSourceDisplay()">Show Source</button></span>
</div>
</footer>
<section id="source">
<pre><code class="nim hljs"><span class="hljs-keyword">import</span> animu, nimib

nbInit(theme=useAdventOfNim)
nbText: <span class="hljs-string">&quot;&quot;&quot;## Day 15: [Chiton](https://adventofcode.com/2021/day/15)

Today is about path search on a grid. I tend to struggle with these
since I never properly studied the theory.

### Part 1

We need to go from top left to bottom right minimizing sum of risk.
My strategy will be to create from given grid a new grid that
at every &quot;node&quot; (it usually pays to think of these problems in terms of graphs),
will tell me the direction I should come from in order to minimize the risk and
get there. The final path will be found by following directions from bottom right.

Here are the inputs:
&quot;&quot;&quot;</span>
nbCode:
  <span class="hljs-keyword">let</span>
    testInput = <span class="hljs-string">&quot;&quot;&quot;
1163751742
1381373672
2136511328
3694931569
7463417111
1319128137
1359912421
3125421639
1293138521
2311944581&quot;&quot;&quot;</span>
    puzzleInput = readFile(<span class="hljs-string">&quot;2021/input15.txt&quot;</span>)
nbText: <span class="hljs-string">&quot;&quot;&quot;I will be using grid code from my Day09 (no blogpost published),
copying and pasting here the useful bits (I will need to think of an ergonomic
way to import from a notebook). I am also fine with having a sentinel value
for stuff outside the grid that is a high value.
&quot;&quot;&quot;</span>
nbCode:
  <span class="hljs-keyword">type</span>
    <span class="hljs-type">Coord</span> = <span class="hljs-keyword">tuple</span>[x, y: <span class="hljs-built_in">int</span>]
    <span class="hljs-type">Grid</span>[<span class="hljs-type">T</span>] = <span class="hljs-keyword">object</span>
      data: <span class="hljs-built_in">seq</span>[<span class="hljs-type">T</span>]
      yLen, xLen: <span class="hljs-built_in">int</span>
      sentinel: <span class="hljs-type">T</span>  <span class="hljs-comment"># value for outside the grid</span>
    <span class="hljs-type">GridInt</span> = <span class="hljs-type">Grid</span>[<span class="hljs-built_in">int</span>]
    <span class="hljs-type">Dir</span> = <span class="hljs-keyword">enum</span>
      right, down, left, up

  <span class="hljs-keyword">func</span> isOutside[<span class="hljs-type">T</span>](c: <span class="hljs-type">Coord</span>, g: <span class="hljs-type">Grid</span>[<span class="hljs-type">T</span>]): <span class="hljs-built_in">bool</span> =
    c.x &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> c.x &gt;= g.xLen <span class="hljs-keyword">or</span> c.y &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> c.y &gt;= g.yLen

  <span class="hljs-keyword">func</span> toIndex[<span class="hljs-type">T</span>](g: <span class="hljs-type">Grid</span>[<span class="hljs-type">T</span>], c: <span class="hljs-type">Coord</span>): <span class="hljs-built_in">int</span> =
    <span class="hljs-keyword">if</span> c.isOutside(g):
      -<span class="hljs-number">1</span>
    <span class="hljs-keyword">else</span>:
      c.y*g.xLen + c.x

  <span class="hljs-keyword">func</span> `[]`[<span class="hljs-type">T</span>](g: <span class="hljs-type">Grid</span>[<span class="hljs-type">T</span>], c: <span class="hljs-type">Coord</span>): <span class="hljs-type">T</span> =
    <span class="hljs-keyword">let</span> i = g.toIndex(c)
    <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">0</span>:
      g.sentinel
    <span class="hljs-keyword">else</span>:
      g.data[i]

  <span class="hljs-keyword">func</span> parseInt(c: <span class="hljs-built_in">char</span>): <span class="hljs-built_in">int</span> =
    <span class="hljs-literal">result</span> = ord(c) - ord(<span class="hljs-string">'0'</span>)
    <span class="hljs-keyword">assert</span> <span class="hljs-literal">result</span> &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-literal">result</span> &lt;= <span class="hljs-number">9</span>

  <span class="hljs-keyword">func</span> parse(text: <span class="hljs-built_in">string</span>): <span class="hljs-type">GridInt</span> =
    <span class="hljs-comment"># result.data = newSeqOfCap(text.len)</span>
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> text.strip.splitLines:
      <span class="hljs-literal">result</span>.data.add line.toSeq.map(parseInt)
      inc <span class="hljs-literal">result</span>.yLen
      <span class="hljs-keyword">if</span> <span class="hljs-literal">result</span>.xLen == <span class="hljs-number">0</span>:
        <span class="hljs-literal">result</span>.xLen = line.len
      <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">assert</span> line.len == <span class="hljs-literal">result</span>.xLen
    <span class="hljs-literal">result</span>.sentinel = <span class="hljs-built_in">int</span>.<span class="hljs-keyword">high</span>

  <span class="hljs-keyword">iterator</span> coords[<span class="hljs-type">T</span>](g: <span class="hljs-type">Grid</span>[<span class="hljs-type">T</span>]): <span class="hljs-type">Coord</span> =
    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> ..&lt; g.yLen:
      <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> ..&lt; g.xLen:
        <span class="hljs-keyword">yield</span> (x, y)

  <span class="hljs-keyword">func</span> `+`(c: <span class="hljs-type">Coord</span>, dir: <span class="hljs-type">Dir</span>): <span class="hljs-type">Coord</span> =
    <span class="hljs-keyword">case</span> dir
    <span class="hljs-keyword">of</span> right:
      (c.x + <span class="hljs-number">1</span>, c.y)
    <span class="hljs-keyword">of</span> down:
      (c.x, c.y + <span class="hljs-number">1</span>)
    <span class="hljs-keyword">of</span> left:
      (c.x - <span class="hljs-number">1</span>, c.y)
    <span class="hljs-keyword">of</span> up:
      (c.x, c.y - <span class="hljs-number">1</span>)
nbText: <span class="hljs-string">&quot;&quot;&quot;
Let's use it to parse inputs:
&quot;&quot;&quot;</span>
nbCode:
  <span class="hljs-keyword">let</span>
    testGrid = parse testInput
    puzzleGrid = parse puzzleInput
  dump (testGrid.xlen, testGrid.ylen)
  dump (puzzleGrid.xlen, puzzleGrid.ylen)
  dump testGrid.sentinel
nbText: <span class="hljs-string">&quot;&quot;&quot;
I am not using a `GridDiff` (I did not copy related code),
I will be using a `GridRisk` which will tell
me minimal total risk up to here and best direction I should come from.

I will also use show functions to debug.
&quot;&quot;&quot;</span>
nbCode:
  <span class="hljs-keyword">type</span>
    <span class="hljs-type">Risk</span> = <span class="hljs-keyword">tuple</span>[risk: <span class="hljs-built_in">int</span>, dir: <span class="hljs-type">Dir</span>]
    <span class="hljs-type">GridRisk</span> = <span class="hljs-type">Grid</span>[<span class="hljs-type">Risk</span>]

  <span class="hljs-keyword">func</span> show(g: <span class="hljs-type">GridInt</span>): <span class="hljs-built_in">string</span> =
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> g.coords:
      <span class="hljs-literal">result</span>.add $g[c]
      <span class="hljs-keyword">if</span> c.x == g.xLen - <span class="hljs-number">1</span>:
        <span class="hljs-literal">result</span>.add <span class="hljs-string">'\n'</span>

  <span class="hljs-keyword">func</span> show(g: <span class="hljs-type">GridRisk</span>, paddingCount=<span class="hljs-number">4</span>): <span class="hljs-built_in">string</span> =
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> g.coords:
      <span class="hljs-literal">result</span>.add align($(g[c].risk), paddingCount)
      <span class="hljs-keyword">if</span> c.x == g.xLen - <span class="hljs-number">1</span>:
        <span class="hljs-literal">result</span>.add <span class="hljs-string">'\n'</span>

  <span class="hljs-keyword">echo</span> show testGrid
nbText: <span class="hljs-string">&quot;&quot;&quot;
Here is the heart of the problem. Key for this is realizing
how to compute incrementally compute the risk.
&quot;&quot;&quot;</span>
nbCode:
  <span class="hljs-keyword">func</span> computeRisk(g: <span class="hljs-type">GridInt</span>, gr: <span class="hljs-type">GridRisk</span>, c: <span class="hljs-type">Coord</span>): <span class="hljs-type">Risk</span> =
    <span class="hljs-comment">## Computes Risk at Coord assuming Risk has been computed</span>
    <span class="hljs-comment">## for cells on the left and above</span>
    <span class="hljs-keyword">let</span>
      riskUp = gr[c + up].risk + g[c]
      riskLeft = gr[c + left].risk + g[c]
    <span class="hljs-comment">#debugEcho &quot;computeRisk for c: &quot;, c</span>
    <span class="hljs-comment">#debugEcho &quot;  riskUp: &quot;, riskUp</span>
    <span class="hljs-comment">#debugEcho &quot;  riskLeft: &quot;, riskLeft</span>
    <span class="hljs-keyword">if</span> riskUp &lt;= riskLeft:
      (riskUp, up)
    <span class="hljs-keyword">else</span>:
      (riskLeft, left)

  <span class="hljs-keyword">func</span> computeGridRisk(g: <span class="hljs-type">GridInt</span>): <span class="hljs-type">GridRisk</span> =
    <span class="hljs-literal">result</span>.xLen = g.xLen
    <span class="hljs-literal">result</span>.yLen = g.ylen
    <span class="hljs-literal">result</span>.sentinel = (g.sentinel - <span class="hljs-number">10</span>, up) <span class="hljs-comment"># forgot this line on first try</span>
    <span class="hljs-comment"># need to do - 10 to avoid overflow</span>
    <span class="hljs-literal">result</span>.data = @[(<span class="hljs-number">0</span>, up)]  <span class="hljs-comment"># risk for initial position does not count</span>
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> g.coords:
      <span class="hljs-keyword">if</span> c == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>): <span class="hljs-keyword">continue</span>
      <span class="hljs-literal">result</span>.data.add g.computeRisk(<span class="hljs-literal">result</span>, c)

  <span class="hljs-keyword">func</span> part1(gr: <span class="hljs-type">GridRisk</span>): <span class="hljs-built_in">int</span> =
    gr[(gr.xLen - <span class="hljs-number">1</span>, gr.yLen - <span class="hljs-number">1</span>)].risk
  
  <span class="hljs-keyword">let</span>
    testGridRisk = computeGridRisk testGrid
    puzzleGridRisk = computeGridRisk puzzleGrid

  <span class="hljs-keyword">echo</span> show testGridRisk

  dump part1 testGridRisk
  dump part1 puzzleGridRisk <span class="hljs-comment"># 719 wrong</span>

  <span class="hljs-keyword">echo</span> show puzzleGridRisk

  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;</span><span class="hljs-meta">\n</span><span class="hljs-meta">\n</span><span class="hljs-string">&quot;</span>, show puzzleGrid
nbText: <span class="hljs-string">&quot;&quot;&quot;
I am stuck at the moment with _a correct test result and an incorrect
puzzle result_. Not really sure how to debug.
&quot;&quot;&quot;</span>

nbSave
</code></pre>
</section><script>
function toggleSourceDisplay() {
  var btn = document.getElementById("show")
  var source = document.getElementById("source");
  if (btn.innerHTML=="Show Source") {
    btn.innerHTML = "Hide Source";
    source.style.display = "block";
  } else {
    btn.innerHTML = "Show Source";
    source.style.display = "none";
  }
}
</script></body>
</html>